<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Java clients
        | Shield - Elasticsearch Security Plugin [shield-1.0]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Shield - Elasticsearch Security Plugin [shield-1.0]" /><link rel="up" href="clients.html" title="Integrating Shield with clients" /><link rel="prev" href="clients.html" title="Integrating Shield with clients" /><link rel="next" href="_http_rest_clients.html" title="HTTP/REST Clients" /><meta name="DC.type" content="Docs/Shield/Reference/shield-1.0" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b>
<br/>
This page is for an as yet unreleased version of the software. Check out the <a href="../current/index.html">latest
version&#39;s documentation here</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Shield - Elasticsearch Security Plugin
      [shield-1.0]
    </a></span> » <span class="breadcrumb-link"><a href="clients.html">Integrating Shield with clients</a></span> » <span class="breadcrumb-node">Java clients</span></div><div class="navheader"><span class="prev"><a href="clients.html">
              « 
              Integrating Shield with clients</a>
           
        </span><span class="next">
           
          <a href="_http_rest_clients.html">HTTP/REST Clients
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_java_clients"></a>Java clients</h2></div></div></div><p>Elasticsearch supports two types of Java clients: <span class="emphasis"><em>Node Client</em></span> and <span class="emphasis"><em>Transport Client</em></span>.</p><p>The <span class="emphasis"><em>Node Client</em></span> is a cluster node that joins the cluster and receives all the cluster events, in the same manner as
any other cluster node. Node clients cannot be allocated shards, and therefore cannot hold data. Node clients are not
eligible for election as a master node in the cluster. For more information about node clients, see the
<a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/client/java-api/1.7/node-client.html" target="_top">following section</a>.</p><p>Unlike the <span class="emphasis"><em>Node Client</em></span>, the <span class="emphasis"><em>Transport Client</em></span> is not a node in the cluster. Yet it uses the same transport protocol
the cluster nodes use for inter-node communication and is therefore considered to be very efficient as it bypasses the
process of un/marshalling of request from/to JSON which you typically have in REST based clients (read more about
<a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/client/java-api/1.7/transport-client.html" target="_top"><span class="emphasis"><em>Transport Client</em></span></a>).</p><p>Shield supports both clients. This section provides configuration instructions for these clients.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_node_client"></a>Node Client</h3></div></div></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>While <span class="emphasis"><em>Node Clients</em></span> may work with Shield, since these are actual nodes in the cluster, they require access
         to a breadth of cluster management internal APIs. Additionally, just like all other nodes in the cluster,
         <span class="emphasis"><em>Node Clients</em></span> require the License plugin to be installed and access to Shield configuration files that contain
         sensitive data. For this reason, <span class="emphasis"><em>Node Clients</em></span> should be considered as unsafe clients. If you choose to use
         these clients, make sure you treat them in the same way you treat any other node in your cluster. Your
         application should sit next to the cluster within the same security zone.</p></div></div><p>There are several steps for setting up this client:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Set the appropriate dependencies for you project
</li><li class="listitem">
Duplicate <a class="link" href="reference.html#ref-shield-files" title="Files used by Shield">configuration files</a> for authentication
</li><li class="listitem">
Configure the authentication token
</li><li class="listitem">
(Optional) If SSL/TLS is enabled, set up the keystore, then create and import the appropriate certificates.
</li></ol></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_java_project_dependencies"></a>Java project dependencies</h4></div></div></div><p>If you plan on using the Node Client, you first need to make sure the Shield jar files (<code class="literal">elasticsearch-shield-1.0.2.jar</code>,
<code class="literal">commons-codec-1.10.jar</code>, <code class="literal">automaton-1.11-8.jar</code>) and the License jar file (<code class="literal">elasticsearch-license-1.0.0.jar</code>) are in
the classpath. You can either download the distributions, extract the jar files manually and include them in your
classpath, or you can pull them out of the Elasticsearch Maven repository.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_maven_example"></a>Maven Example</h4></div></div></div><p>The following snippet shows the configuration you will need to include in your project’s <code class="literal">pom.xml</code> file:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-xml">&lt;project ...&gt;

   &lt;repositories&gt;
      &lt;!-- add the elasticsearch repo --&gt;
      &lt;repository&gt;
         &lt;id&gt;elasticsearch-releases&lt;/id&gt;
         &lt;url&gt;http://maven.elasticsearch.org/releases&lt;/url&gt;
         &lt;releases&gt;
            &lt;enabled&gt;true&lt;/enabled&gt;
         &lt;/releases&gt;
         &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
         &lt;/snapshots&gt;
      &lt;/repository&gt;
      ...
   &lt;/repositories&gt;
   ...

   &lt;dependencies&gt;
      &lt;!-- add the Shield jar as a dependency --&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.elasticsearch&lt;/groupId&gt;
         &lt;artifactId&gt;elasticsearch-shield&lt;/artifactId&gt;
         &lt;version&gt;1.0.2&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;!-- add the License jar as a dependency --&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.elasticsearch&lt;/groupId&gt;
         &lt;artifactId&gt;elasticsearch-license-plugin&lt;/artifactId&gt;
         &lt;version&gt;1.0.0&lt;/version&gt;
         &lt;scope&gt;runtime&lt;/scope&gt;
      &lt;/dependency&gt;
      ...
   &lt;/dependencies&gt;
   ...

 &lt;/project&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_gradle_example"></a>Gradle Example</h4></div></div></div><p>If you are using Gradle, then you will need to add the dependencies to your <code class="literal">build.gradle</code> file:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-groovy">repositories {
  /* ... Any other repositories ... */

  // Add the Elasticsearch Maven Repository
  maven {
    url "http://maven.elasticsearch.org/releases"
  }
}

dependencies {
  // Provide the Shield jar on the classpath for compilation and at runtime
  // Note: Many projects can use the Shield jar as a runtime dependency
  compile "org.elasticsearch:elasticsearch-shield:1.0.2"

  /* ... */

  // Provide the License jar on the classpath at runtime (not needed for compilation)
  runtime "org.elasticsearch:elasticsearch-license-plugin:1.0.0"
}</pre></div><p>It is also possible to manually download the <a class="ulink" href="http://maven.elasticsearch.org/releases/org/elasticsearch/elasticsearch-shield/1.0.2/elasticsearch-shield-1.0.2.jar" target="_top">Shield jar</a>
and the <a class="ulink" href="http://maven.elasticsearch.org/releases/org/elasticsearch/elasticsearch-license-plugin/1.0.0/elasticsearch-license-plugin-1.0.0.jar" target="_top">License jar</a>
files from our Maven repository.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_duplicate_shield_configuration_files"></a>Duplicate Shield Configuration Files</h4></div></div></div><p>The <span class="emphasis"><em>Node Client</em></span> will authenticate requests before sending the requests to the cluster. To do this, copy the <code class="literal">users</code>,
<code class="literal">users_roles</code>, <code class="literal">roles.yml</code>, and <code class="literal">system_key</code> files from the <a class="link" href="reference.html#ref-shield-files" title="Files used by Shield">Shield configuration files</a> to a place
accessible to the node client. These files should be stored on the filesystem in a folder with restricted access as they
contain sesnitive data. This can be configured with the following settings:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">shield.authc.realms.esusers.files.users</code>
</li><li class="listitem">
<code class="literal">shield.authc.realms.esusers.files.users_roles</code>
</li><li class="listitem">
<code class="literal">shield.authz.store.files.roles</code>
</li><li class="listitem">
<code class="literal">shield.system_key.file</code>
</li></ul></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import static org.elasticsearch.node.NodeBuilder.*;
...
Node node = nodeBuilder().client(true).settings(ImmutableSettings.builder()
    .put("cluster.name", "myClusterName")
    .put("discovery.zen.ping.multicast.enabled", false)
    .putArray("discovery.zen.ping.unicast.hosts", "localhost:9300", "localhost:9301")
    .put("shield.authc.realms.esusers.type", "esusers")
    .put("shield.authc.realms.esusers.files.users", "/Users/es/config/shield/users")
    .put("shield.authc.realms.esusers.files.users_roles", "/Users/es/config/shield/users_roles")
    .put("shield.authz.store.files.roles", "/Users/es/config/shield/roles.yml")
    .put("shield.system_key.file", "/Users/es/config/shield/system_key"))
    ...
    .node();</pre></div><p>Additionally, if you are using LDAP or Active Directory authentication then you will need to specify that configuration
in the settings when configuring the node or provide a <code class="literal">elasticsearch.yml</code> in the classpath with the appropriate settings.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_configuring_authentication_token"></a>Configuring Authentication Token</h4></div></div></div><p>The authentication token can be configured in two ways - globally or per-request. When setting it up globally, the
values of the username and password are configured in the client’s settings:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import static org.elasticsearch.node.NodeBuilder.*;
import static org.elasticsearch.shield.authc.support.UsernamePasswordToken.basicAuthHeaderValue;
...

Node node = nodeBuilder().client(true).settings(ImmutableSettings.builder()
    ...
    .put("shield.user", "test_user:changeme"))
    ...
    .node();
Client client = node.client();</pre></div><p>Once the client is created as above, the <code class="literal">shield.user</code> setting is translated to a request header in the standard HTTP
basic authentication form <code class="literal">Authentication base64("test_user:changeme")</code> which will be sent with every request executed.</p><p>To skip the global configuration of the token, manually set the authentication token header on every request:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import org.elasticsearch.shield.authc.support.SecuredString;

import static org.elasticsearch.node.NodeBuilder.*;
import static org.elasticsearch.shield.authc.support.UsernamePasswordToken.basicAuthHeaderValue;
...

String token = basicAuthHeaderValue("test_user", new SecuredString("changeme".toCharArray()));
Node node = nodeBuilder().client(true).settings(ImmutableSettings.builder()
    ...
    .node();
Client client = node.client();

client.prepareSearch().putHeader("Authorization", token).get();</pre></div><p>The example above executes a search request and manually adds the authentication token as a header on it.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_setting_up_ssl"></a>Setting up SSL</h4></div></div></div><p>Authenticating to the cluster requires proof that a node client is trusted as part of the cluster. This is done through
standard PKI and SSL. A client node creates a private key and an associated certificate. The cluster Certificate
Authority signs the certificate. A Client node authenticates during the SSL connection setup by presenting the signed
certificate, and proving ownership of the private key. All of these setup steps are described in
<a class="link" href="private-key.html" title="Generate a node private key and certificate">Securing Nodes</a>.</p><p>In addition, the node client acts like a node, authenticating locally any request made. Copies of the files <code class="literal">users</code>,
<code class="literal">users_roles</code>, <code class="literal">roles.yml</code> , and <code class="literal">system_key</code> need to be made available to the node client.</p><p>After following the steps in <a class="link" href="private-key.html" title="Generate a node private key and certificate">Securing Nodes</a>, configuration for a node client with Shield might look
like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import static org.elasticsearch.node.NodeBuilder.*;
...
Node node = nodeBuilder().client(true).settings(ImmutableSettings.builder()
    .put("cluster.name", "myClusterName")
    .put("discovery.zen.ping.multicast.enabled", false)
    .putArray("discovery.zen.ping.unicast.hosts", "localhost:9300", "localhost:9301")
    .put("shield.ssl.keystore.path", "/Users/es/node_client/node_client.jks")
    .put("shield.ssl.keystore.password", "password")
    .put("shield.transport.ssl", "true")
    .put("shield.authc.realms.esusers.type", "esusers")
    .put("shield.authc.realms.esusers.files.users", "/Users/es/config/shield/users")
    .put("shield.authc.realms.esusers.files.users_roles", "/Users/es/config/shield/users_roles")
    .put("shield.authz.store.files.roles", "/Users/es/config/shield/roles.yml")
    .put("shield.system_key.file", "/Users/es/config/shield/system_key"))
    ...
    .node();</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transport-client"></a>Transport Client</h3></div></div></div><p>If you plan on using the Transport Client over SSL/TLS you first need to make sure the Shield jar files
(<code class="literal">elasticsearch-shield-1.0.2.jar</code>, <code class="literal">commons-codec-1.10.jar</code>) are in the classpath. You can either download the
Shield distribution, extract the jar files manually and include them in your classpath, or you can pull them out of the Elasticsearch Maven repository.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Unlike the <span class="emphasis"><em>Node Client</em></span>, the <span class="emphasis"><em>Transport Client</em></span> is not acting as a node in the cluster, and therefore
        <span class="strong"><strong>does not</strong></span> require the License plugin to be installed.</p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_maven_example_2"></a>Maven Example</h4></div></div></div><p>The following snippet shows the configuration you will need to include in your project’s <code class="literal">pom.xml</code> file:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-xml">&lt;project ...&gt;

   &lt;repositories&gt;
      &lt;!-- add the elasticsearch repo --&gt;
      &lt;repository&gt;
         &lt;id&gt;elasticsearch-releases&lt;/id&gt;
         &lt;url&gt;http://maven.elasticsearch.org/releases&lt;/url&gt;
         &lt;releases&gt;
            &lt;enabled&gt;true&lt;/enabled&gt;
         &lt;/releases&gt;
         &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
         &lt;/snapshots&gt;
      &lt;/repository&gt;
      ...
   &lt;/repositories&gt;
   ...

   &lt;dependencies&gt;
      &lt;!-- add the shield jar as a dependency --&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.elasticsearch&lt;/groupId&gt;
         &lt;artifactId&gt;elasticsearch-shield&lt;/artifactId&gt;
         &lt;version&gt;1.0.2&lt;/version&gt;
      &lt;/dependency&gt;
      ...
   &lt;/dependencies&gt;
   ...

 &lt;/project&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_gradle_example_2"></a>Gradle Example</h4></div></div></div><p>If you are using Gradle, then you will need to add the dependencies to your <code class="literal">build.gradle</code> file:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-groovy">repositories {
  /* ... Any other repositories ... */

  // Add the Elasticsearch Maven Repository
  maven {
    url "http://maven.elasticsearch.org/releases"
  }
}

dependencies {
  // Provide the Shield jar on the classpath for compilation and at runtime
  // Note: Many projects can use the Shield jar as a runtime dependency
  compile "org.elasticsearch:elasticsearch-shield:1.0.2"

  /* ... */
}</pre></div><p>It is also possible to manually download the <a class="ulink" href="http://maven.elasticsearch.org/releases/org/elasticsearch/elasticsearch-shield/1.0.2/elasticsearch-shield-1.0.2.jar" target="_top">Shield jar</a>
file from our Maven repository.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>Even if you are not planning on using the client over SSL/TLS, it is still worth having the Shield jar file in
        the classpath as it provides various helpful utilities, such as the <code class="literal">UsernamePasswordToken</code> class for generating
        basic-auth tokens and the <code class="literal">ShieldClient</code> that <a class="link" href="_java_clients.html#shield-client" title="Shield Client">exposes an API</a> to clear realm caches.</p></div></div><p>Before setting up the client itself, you need to make sure you have a user with sufficient privileges to start
the transport client.  The transport client uses Elasticsearch’s node info API to fetch information about the
nodes in the cluster.  For this reason, the authenticated user of the transport client must have the
<code class="literal">cluster:monitor/nodes/info</code> cluster permission.  Furthermore, if the client is configured to use sniffing, the
<code class="literal">cluster:monitor/state</code> cluster permission is required.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p><code class="literal">roles.yml</code> ships with a predefined <code class="literal">transport_client</code> role. By default it is configured to only grant the
        <code class="literal">cluster:monitor/nodes/info</code> cluster permission. You can use this role and assign it to any user
        that will be attached to a transport client.</p></div></div><p>Setting up the transport client is similar to the Node client except authentication files do not need to be configured.
Without SSL, it is as easy as setting up the authentication token on the request, similarly to how they’re set up with
the <span class="emphasis"><em>Node Client</em></span>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import org.elasticsearch.client.transport.TransportClient;
...

TransportClient client = new TransportClient(ImmutableSettings.builder()
    .put("cluster.name", "myClusterName")
    .put("shield.user", "test_user:changeme")
    .addTransportAddress(new InetSocketTransportAddress("localhost", 9300))
    .addTransportAddress(new InetSocketTransportAddress("localhost", 9301));</pre></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>Configuring a Transport Client without SSL will send passwords in plaintext.</p></div></div><p>When using SSL for transport client communication, a few more settings are required. By default, Shield requires client
authentication for secured transport communication. This means that every client would need to have a certificate signed
by a trusted CA. The client authentication can be disabled through the use of a <a class="link" href="separating-node-client-traffic.html" title="Separating node to node and client traffic">client specific transport profile</a>.</p><p>Configuration required for SSL when using client authentication:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import org.elasticsearch.client.transport.TransportClient;
...

TransportClient client = new TransportClient(ImmutableSettings.builder()
    .put("cluster.name", "myClusterName")
    .put("shield.user", "test_user:changeme")
    .put("shield.ssl.keystore.path", "/path/to/client.jks")
    .put("shield.ssl.keystore.password", "password")
    .put("shield.transport.ssl", "true"))
    .addTransportAddress(new InetSocketTransportAddress("localhost", 9300))
    .addTransportAddress(new InetSocketTransportAddress("localhost", 9301));</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">client.jks</code> keystore needs to contain the client’s signed CA certificate and the CA certificate.</p></div></div><p>Configuration required for SSL without client authentication:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import org.elasticsearch.client.transport.TransportClient;
...

TransportClient client = new TransportClient(ImmutableSettings.builder()
    .put("cluster.name", "myClusterName")
    .put("shield.user", "test_user:changeme")
    .put("shield.ssl.truststore.path", "/path/to/truststore.jks")
    .put("shield.ssl.truststore.password", "password")
    .put("shield.transport.ssl", "true"))
    .addTransportAddress(new InetSocketTransportAddress("localhost", 9300))
    .addTransportAddress(new InetSocketTransportAddress("localhost", 9301));</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The ‘truststore.jks` truststore needs to contain the certificate of the CA that has signed the Elasticsearch nodes’
certificates. If you are using a public CA that is already trusted by the Java runtime, then you can omit
<code class="literal">shield.ssl.truststore.path</code> and <code class="literal">shield.ssl.truststore.password</code>.</p></div></div><p>In the above code snippets, we set up a <span class="emphasis"><em>Transport Client</em></span> and configured the authentication token globally. Meaning,
that every request executed with this client will include this token in its headers.</p><p>The global configuration of the token <span class="strong"><strong>must be</strong></span> set to some user with the privileges in the default <code class="literal">transport_client</code>
role, as described earlier. The global authentication token may also be overridden by adding a <code class="literal">Authorization</code> header on
each request. This is useful when an application uses multiple users to access Elasticsearch via the same client. When
operating in this mode, it is best to set the global token to a user that only has the <code class="literal">transport_client</code> role. The
following example directly sets the authentication token on the request when executing a search.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import org.elasticsearch.shield.authc.support.SecuredString;
import org.elasticsearch.client.transport.TransportClient;

import static org.elasticsearch.shield.authc.support.UsernamePasswordToken.basicAuthHeaderValue;
...

String token = basicAuthHeaderValue("test_user", new SecuredString("changeme".toCharArray()));
TransportClient client = new TransportClient(ImmutableSettings.builder()
    .put("shield.user", "transport_client_user:changeme")
    ...
    .addTransportAddress(new InetSocketTransportAddress("localhost", 9300))
    .addTransportAddress(new InetSocketTransportAddress("localhost", 9301));

client.prepareSearch().putHeader("Authorization", token).get();</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="shield-client"></a>Shield Client</h3></div></div></div><p>Shield exposes its own API to the user which is accessible by the <code class="literal">ShieldClient</code> class. The purpose of this API
 is to manage all Shield related aspects. While at the moment it only exposes an operation for clearing up the
 realm caches, the plan is to extend this API in the future.</p><p><code class="literal">ShieldClient</code> is a wrapper around the existing clients (any client class implementing <code class="literal">org.elasticsearch.client.Client</code>.</p><pre class="literallayout">The following example shows how one can clear up Shield's realm caches using the `ShieldClient`:</pre><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import static org.elasticsearch.node.NodeBuilder.*;
...

Client client = ... // create the client (either transport or node)

ShieldClient shieldClient = new ShieldClient(client);
ClearRealmCacheResponse response = shieldClient.authc().prepareClearRealmCache()
    .realms("ldap1", "ad1")
    .usernames("rdeniro")
    .get();</pre></div><p>In the example above, we clear the caches of two realms - <code class="literal">ldap1</code> and <code class="literal">ad1</code> - for the <code class="literal">rdeniro</code> user.</p></div></div><div class="navfooter"><span class="prev"><a href="clients.html">
              « 
              Integrating Shield with clients</a>
           
        </span><span class="next">
           
          <a href="_http_rest_clients.html">HTTP/REST Clients
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        