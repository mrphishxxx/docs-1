<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Actions
        | X-Pack for the Elastic Stack
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="X-Pack for the Elastic Stack" /><link rel="up" href="watcher-reference.html" title="Reference" /><link rel="prev" href="condition.html" title="Conditions" /><link rel="next" href="transform.html" title="Transforms" /><meta name="DC.type" content="Docs/XPack/Reference" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b> These docs are for a pre-GA version of X-Pack, 5.0.0-alpha3.</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">X-Pack for the Elastic Stack</a></span> » <span class="breadcrumb-link"><a href="xpack-alerting.html">Watcher - Alerting &amp; Notification </a></span> » <span class="breadcrumb-link"><a href="watcher-reference.html">Reference</a></span> » <span class="breadcrumb-node">Actions</span></div><div class="navheader"><span class="prev"><a href="condition.html">
              « 
              Conditions</a>
           
        </span><span class="next">
           
          <a href="transform.html">Transforms
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions"></a>Actions</h2></div></div></div><p>The actions associated with a watch are executed whenever the watch is executed,
its condition is met, and the watch is not throttled. The actions are executed
one at a time and each action executes independently from the others. Any failures
encountered while executing an action are recorded in the action result and in
the watch history.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If no actions are defined for a watch, no actions are executed. However, a
                        <code class="literal">watch_record</code> is still written to the watch history.</p></div></div><p>Actions have access to the payload in the execution context. They can use it to
support their execution in any way they need. For example, the payload might
serve as a model for a templated email body.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="actions-ack-throttle"></a>Acknowledgement and Throttling</h3></div></div></div><p>During the watch execution, once the condition is met, a decision is made per
configured action as to whether it should be throttled. The main purpose of
action throttling is to prevent too many executions of the same action for the
same watch.</p><p>For example, suppose you have a watch that detects errors in an application’s log
entries. The watch is triggered every five minutes and searches for errors during
the last hour. In this case, if there are errors, there is a period of time where
the watch is checked and its actions are executed multiple times based on the same
errors. As a result, the system administrator receives multiple notifications about
the same issue, which can be annoying.</p><p>To address this issue, Watcher supports time-based throttling. You can define
a throttling period as part of the action configuration to limit how often the
action is executed. When you set a throttling period, Watcher prevents repeated
execution of the action if it has already executed within the throttling period
time frame (<code class="literal">now - throttling period</code>).</p><p>The following snippet shows a watch for the scenario described above - associating
a throttle period with the <code class="literal">email_administrator</code> action:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT _xpack/watcher/watch/error_logs_alert
{
  "metadata" : {
    "color" : "red"
  },
  "trigger" : {
    "schedule" : {
      "interval" : "5m"
    }
  },
  "input" : {
    "search" : {
      "request" : {
        "indices" : "log-events",
        "body" : {
          "size" : 0,
          "query" : { "match" : { "status" : "error" } }
        }
      }
    }
  },
  "condition" : {
    "script" : "return ctx.payload.hits.total &gt; 5"
  },
  "actions" : {
    "email_administrator" : {
      "throttle_period": "15m", <a id="CO50-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      "email" : { <a id="CO50-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        "to" : "sys.admino@host.domain",
        "subject" : "Encountered {{ctx.payload.hits.total}} errors",
        "body" : "Too many error in the system, see attached data",
        "attachments" : {
          "attached_data" : {
            "data" : {
              "format" : "json"
            }
          }
        },
        "priority" : "high"
      }
    }
  }
}</pre></div><div class="console_widget" data-snippet="snippets/actions/1.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO50-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
There will be at least 15 minutes between subsequent <code class="literal">email_administrator</code>
                action executions.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO50-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
See <a class="link" href="actions.html#actions-email" title="Email Action">Email Action</a> for more information.
</p></td></tr></table></div><p>You can also define a throttle period at the watch level. The watch-level
throttle period serves as the default throttle period for all of the actions
defined in the watch:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT _xpack/watcher/watch/log_event_watch
{
  "trigger" : {
    ...
  },
  "input" : {
    ...
  },
  "condition" : {
    ...
  },
  "throttle_period" : "15m", <a id="CO51-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  "actions" : {
    "email_administrator" : {
      "email" : {
        "to" : "sys.admino@host.domain",
        "subject" : "Encountered {{ctx.payload.hits.total}} errors",
        "body" : "Too many error in the system, see attached data",
        "attachments" : {
          "attached_data" : {
            "data" : {
              "format" : "json"
            }
          }
        },
        "priority" : "high"
      }
    },
    "notify_pager" : {
      "webhook" : {
        "method" : "POST",
        "host" : "pager.service.domain",
        "port" : 1234,
        "path" : "/{{watch_id}}",
        "body" : "Encountered {{ctx.payload.hits.total}} errors"
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO51-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
There will be at least 15 minutes between subsequent action executions
                (applies to both <code class="literal">email_administrator</code> and <code class="literal">notify_pager</code> actions)
</p></td></tr></table></div><p>If you do not define a throttle period at the action or watch level, the global
default throttle period is applied. Initially, this is set to 5 seconds. To
change the global default, configure the <code class="literal">xpack.watcher.execution.default_throttle_period</code>
setting in <code class="literal">elasticsearch.yml</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.watcher.execution.default_throttle_period: 15m</pre></div><p>Watcher also supports acknowledgement-based throttling. You can acknowledge a
watch using the <a class="link" href="watcher-api-ack-watch.html" title="Ack Watch API">Ack Watch API</a> to prevent the watch actions
from being executed again while the watch condition remains <code class="literal">true</code>. This essentially
tells Watcher "I received the notification and I’m handling it, please do not
notify me about this error again". An acknowledged watch action remains in the
<code class="literal">acked</code> state until the watch’s condition evaluates to <code class="literal">false</code>. When that happens,
the action’s state changes to <code class="literal">awaits_successful_execution</code>.</p><p>To acknowledge an action, you use the <a class="link" href="watcher-api-ack-watch.html" title="Ack Watch API">Ack Watch API</a>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT _xpack/watcher/watch/&lt;id&gt;/_ack?actions=&lt;action_ids&gt;</pre></div><div class="console_widget" data-snippet="snippets/actions/2.json"></div><p>Where <code class="literal">&lt;id&gt;</code> is the id of the watch and <code class="literal">&lt;action_ids&gt;</code> is a comma-separated list
of the action ids you want to acknowledge. To acknowledge all actions, omit the
<code class="literal">actions</code> parameter.</p><p>The following diagram illustrates the throttling decisions made for each action
of a watch during its execution:</p><div class="informalfigure"><div class="mediaobject" align="center"><img src="images/watcher/action-throttling.jpg" align="middle" alt="action-throttling.jpg" /></div></div><p>Watcher supports the following action types: <a class="link" href="actions.html#actions-email" title="Email Action">Email</a>,
<a class="link" href="actions.html#actions-webhook" title="Webhook Action">Webhook</a>, <a class="link" href="actions.html#actions-index" title="Index Action">Index</a>, <a class="link" href="actions.html#actions-logging" title="Logging Action">Logging</a>,
<a class="link" href="actions.html#actions-hipchat" title="HipChat Action">HipChat</a>, <a class="link" href="actions.html#actions-slack" title="Slack Action">Slack</a> and <a class="link" href="actions.html#actions-pagerduty" title="PagerDuty Action">Pager Duty</a></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="actions-email"></a>Email Action</h3></div></div></div><p>A watch <a class="link" href="actions.html" title="Actions">action</a> that sends email notifications. To use the <code class="literal">email</code>
action, you must configure at least one email account. For instructions, see
<a class="link" href="configuring-email.html" title="Configuring Email">Configuring Email Accounts</a>.</p><p>See <a class="xref" href="actions.html#email-action-attributes" title="Email Action Attributes">the section called “Email Action Attributes”</a> for the supported attributes. Any attributes that
are missing from the email action definition are looked up in the configuration
of the account from which the email is being sent. The required attributes must
either be set in the email action definition or the account’s <code class="literal">email_defaults</code>.</p><h5><a id="configuring-email-actions"></a>Configuring Email Actions</h5><p>You configure email actions in the <code class="literal">actions</code> array. Action-specific attributes are
specified using the <code class="literal">email</code> keyword.</p><p>The following snippet shows a basic email action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "email_admin" : { <a id="CO52-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "transform" : { ... }, <a id="CO52-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    "email": {
      "to": "'John Doe &lt;john.doe@example.com&gt;'", <a id="CO52-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
      "subject": "{{ctx.watch_id}} executed", <a id="CO52-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
      "body": "{{ctx.watch_id}} executed with {{ctx.payload.hits.total}} hits" <a id="CO52-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO52-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The id of the action.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO52-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="transform.html" title="Transforms">transform</a> to transform the payload before
    processing the email.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO52-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
One or more addresses to send the email to. If not specified, the <code class="literal">to</code>
    address is read from the account’s <code class="literal">email_defaults</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO52-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The subject of the email (static text or a Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">template</a>).
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO52-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The body of the email (static text or a Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">template</a>).
</p></td></tr></table></div><h5><a id="configuring-email-attachments"></a>Configuring Email Attachments</h5><p>You can attach the execution context payload or data from an any HTTP service to
the email notification. There is no limit on the number of attachments you can
configure.</p><p>To configure attachments, specify a name for the attached file and the type of
attachment: <code class="literal">data</code> or <code class="literal">http</code>. The <code class="literal">data</code> attachment type attaches the execution
context payload to the email message. The <code class="literal">http</code> attachment type enables
you to issue an HTTP request and attach the response to the email message. When
configuring the <code class="literal">http</code> attachment type, you must specify the request URL.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "email_admin" : {
    "email": {
      "to": "'John Doe &lt;john.doe@example.com&gt;'",
      "attachments" : {
        "my_report.pdf" : { <a id="CO53-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
          "http" : { <a id="CO53-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
            "content_type" : "application/pdf",
            "request" : {
              "url": "http://example.org/foo/my-report" <a id="CO53-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
            }
          }
        },
        "data.yml" : {
          "data" : {
            "format" : "yaml" <a id="CO53-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
          }
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO53-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The ID of the attachment, which is used as the file name in the email
    attachment.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO53-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The type of the attachment and its specific configuration.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO53-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The URL from which to retrieve the attachment.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO53-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Data attachments default to JSON if you don’t specify the format.
</p></td></tr></table></div><div class="table"><a id="id-1.7.9.6.6.14"></a><p class="title"><strong>Table 33. <code class="literal">http</code> attachment type attributes</strong></p><div class="table-contents"><table summary="http attachment type attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name            </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">content_type</code></p></td><td align="left" valign="top"><p>Sets the content type for the email attachment. By default,
                    the content type is extracted from the response sent by the
                    HTTP service. You can explicitly specify the content type to
                    ensure that the type is set correctly in the email in case
                    the response does not specify the content type or it’s specified
                    incorrectly. Optional.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>Contains the HTTP request attributes. At a minimum, you must
                    specify the <code class="literal">url</code> attribute to configure the host and path to
                    the service endpoint. See <a class="xref" href="actions.html#webhook-action-attributes">???</a> for
                    the full list of HTTP request attributes. Required.</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.7.9.6.6.15"></a><p class="title"><strong>Table 34. <code class="literal">data</code> attachment type attributes</strong></p><div class="table-contents"><table summary="data attachment type attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name        </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">format</code></p></td><td align="left" valign="top"><p>Attaches the watch data, equivalent to specifying <code class="literal">attach_data</code>
                in the watch configuration. Possible values are <code class="literal">json</code> or <code class="literal">yaml</code>.
                Defaults to <code class="literal">json</code> if not specified.</p></td></tr></tbody></table></div></div><br class="table-break" /><h5><a id="email-action-attributes"></a>Email Action Attributes</h5><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name                  </th><th align="center" valign="top">Required   </th><th align="left" valign="top"> Default             </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">account</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>the default account</p></td><td align="left" valign="top"><p>The <a class="link" href="configuring-email.html#email-account" title="Email Accounts">account</a> to use to send the email.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">from</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">address</a> from which the email
                                                            will be sent. The <code class="literal">from</code> field can contain Mustache
                                                            <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a> as long as it resolves to a
                                                            valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">to</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">addresses</a> of the <code class="literal">to</code> recipients.
                                                            The <code class="literal">to</code> field can contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>
                                                            as long as it resolves to a valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cc</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">addresses</a> of the <code class="literal">cc</code> recipients.
                                                            The <code class="literal">cc</code> field can contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>
                                                            as long as it resolves to a valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcc</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">addresses</a> of the <code class="literal">bcc</code> recipients.
                                                            The <code class="literal">bcc</code> field can contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>
                                                            as long as it resolves to a valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">reply_to</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">addresses</a> that will be set on the
                                                            message’s <code class="literal">Reply-To</code> header. The <code class="literal">reply_to</code> field can contain
                                                            Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a> as long as it resolves to
                                                            a valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">subject</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The subject of the email. The subject can be static text or
                                                            contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">body</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The body of the email. When this field holds a string, it
                                                            will default to the text body of the email. Set as an object
                                                            to specify either the text or the html body or both (using
                                                            the fields below)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">body.text</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The plain text body of the email. The body can be static text
                                                            or contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>. The email <code class="literal">body</code>
                                                            must contain at least one <code class="literal">text</code> or <code class="literal">html</code> field.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">body.html</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The html body of the email. The body can be static text or
                                                            contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>. This body will be
                                                            sanitized to remove dangerous content such as scripts. This
                                                            behavior can be disabled by setting
                                                            <code class="literal">xpack.notification.email.sanitize_html: false</code> in
                                                            <code class="literal">elasticsearch.yaml</code>. The email <code class="literal">body</code> must contain at least
                                                            one <code class="literal">text</code> or <code class="literal">html</code> field.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">priority</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The priority of this email. Valid values are: <code class="literal">lowest</code>, <code class="literal">low</code>,
                                                            <code class="literal">normal</code>, <code class="literal">high</code> and <code class="literal">highest</code>. The priority can contain a
                                                            Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">template</a> as long as it resolves to
                                                            one of the valid values.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attachments</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>Attaches the watch payload (<code class="literal">data</code> attachment) or a file
                                                            retrieved from an HTTP service (<code class="literal">http</code> attachment) to the
                                                            email. For more information, see
                                                            <a class="link" href="actions.html#configuring-email-attachments" title="Configuring Email Attachments">Configuring Email Attachments</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attach_data</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>Indicates whether the watch execution data should be attached
                                                            to the email. You can specify a Boolean value or an object.
                                                            If <code class="literal">attach_data</code> is set to  <code class="literal">true</code>, the data is attached as a
                                                            YAML file. This attribute is deprecated, use the <code class="literal">attachments</code>
                                                            attribute to add a <code class="literal">data</code> attachment to attach the watch payload.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attach_data.format</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>yaml</p></td><td align="left" valign="top"><p>When <code class="literal">attach_data</code> is specified as an object, this field
                                                            controls the format of the attached data. The supported formats
                                                            are <code class="literal">json</code> and <code class="literal">yaml</code>. This attribute is deprecated, use the
                                                            <code class="literal">attachments</code> attribute to add a <code class="literal">data</code> attachment to attach
                                                            the watch payload.</p></td></tr></tbody></table></div><div class="variablelist"><a id="email-address"></a><dl class="variablelist"><dt><span class="term">
Email Address
</span></dt><dd>
An email address can contain two possible parts—the address itself and an
optional personal name as described in <a class="ulink" href="http://www.ietf.org/rfc/rfc822.txt" target="_top">RFC 822</a>.
The address can be represented either as a string of the form <code class="literal">user@host.domain</code>
or <code class="literal">Personal Name &lt;user@host.domain&gt;</code>. You can also specify an email address as
an object that contains <code class="literal">name</code> and <code class="literal">address</code> fields.
</dd><dt><span class="term">
Address List
</span></dt><dd>
A list of addresses can either be specified as a comma-delimited string or as an
array: <code class="literal">'Personal Name &lt;user1@host.domain&gt;, user2@host.domain'</code> or
<code class="literal">[ 'Personal Name &lt;user1@host.domain&gt;', 'user2@host.domain' ]</code>.
</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="actions-webhook"></a>Webhook Action</h3></div></div></div><p>A watch <a class="link" href="actions.html" title="Actions">action</a> that connects to a web server and listens on a
specific port. The webhook action supports both HTTP and HTTPS connections. See
<a class="xref" href="actions.html#webhook-action-attributes">???</a> for the supported attributes.</p><h5><a id="configuring-webook-actions"></a>Configuring Webhook Actions</h5><p>You configure webhook actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">webhook</code> keyword.</p><p>The following snippet shows a simple webhook action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "my_webhook" : { <a id="CO54-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "transform" : { ... }, <a id="CO54-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    "throttle_period" : "5m", <a id="CO54-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
    "webhook" : {
      "method" : "POST", <a id="CO54-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
      "host" : "mylisteningserver", <a id="CO54-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
      "port" : 9200, <a id="CO54-6"></a><span><img src="images/icons/callouts/6.png" alt="" /></span>
      "path": ":/{{ctx.watch_id}", <a id="CO54-7"></a><span><img src="images/icons/callouts/7.png" alt="" /></span>
      "body" : "{{ctx.watch_id}}:{{ctx.payload.hits.total}}" <a id="CO54-8"></a><span><img src="images/icons/callouts/8.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO54-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The id of the action
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO54-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="transform.html" title="Transforms">transform</a> to transform the payload before
    executing the <code class="literal">webhook</code> action
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO54-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="actions.html#actions-ack-throttle" title="Acknowledgement and Throttling">throttle period</a> for the action
    (5 minutes in this example)
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO54-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The HTTP method to use when connecting to the host
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO54-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The host to connect to
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO54-6"><span><img src="images/icons/callouts/6.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The port to connect to
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO54-7"><span><img src="images/icons/callouts/7.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The path (URI) to use in the HTTP request
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO54-8"><span><img src="images/icons/callouts/8.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The body to send with the request
</p></td></tr></table></div><p>You can use basic authentication when sending a request to a secured webservice.
For example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "my_webhook" : {
    "webhook" : {
      "auth" : {
        "basic" : {
          "username" : "&lt;username&gt;", <a id="CO55-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
          "password" : "&lt;password&gt;" <a id="CO55-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        }
      }
      "method" : "POST",
      "host" : "mylisteningserver",
      "port" : 9200,
      "path": ":/{{ctx.watch_id}",
      "body" : "{{ctx.watch_id}}:{{ctx.payload.hits.total}}"
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO55-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The username
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO55-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The corresponding password
</p></td></tr></table></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>By default, both the username and the password are stored in the <code class="literal">.watches</code>
      index in plain text. When X-Pack Security is enabled, Watcher can encrypt the
      password before storing it.</p></div></div><p>You can also use PKI-based authentication when submitting requests to a cluster
secured with X-Pack Security. When you use PKI-based authentication instead of HTTP
basic auth, you don’t need to store any authentication information in the watch
itself. To use PKI-based authentication, you configure the SSL keystore path and
password for Watcher in <code class="literal">elasticsearch.yml</code>. If the <code class="literal">xpack.watcher.http.ssl.keystore.path</code>
and <code class="literal">xpack.watcher.http.ssl.keystore</code> password are not set, the Watcher HTTP
client falls back to the X-Pack Security settings,  <code class="literal">xpack.security.ssl.keystore.path</code>
and <code class="literal">xpack.security.ssl.keystore.password</code>.</p><h5><a id="webhook-query-parameters"></a>Query Parameters</h5><p>You can specify query parameters to send with the request with the <code class="literal">params</code> field.
This field simply holds an object where the keys serve as the parameter names and
the values serve as the parameter values:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "my_webhook" : {
    "webhook" : {
      "method" : "POST",
      "host" : "mylisteningserver",
      "port" : 9200,
      "path": ":/alert",
      "params" : {
        "watch_id" : "{{ctx.watch_id}}" <a id="CO56-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO56-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The parameter values can contain templated strings.
</p></td></tr></table></div><h5><a id="webhook-custom-request-headers"></a>Custom Request Headers</h5><p>You can specify request headers to send with the request with the <code class="literal">headers</code> field.
This field simply holds an object where the keys serve as the header names and
the values serve as the header values:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "my_webhook" : {
    "webhook" : {
      "method" : "POST",
      "host" : "mylisteningserver",
      "port" : 9200,
      "path": ":/alert/{{ctx.watch_id}}",
      "headers" : {
        "Content-Type" : "application/yaml" <a id="CO57-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      },
      "body" : "count: {{ctx.payload.hits.total}}"
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO57-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The header values can contain templated strings.
</p></td></tr></table></div><h5><a id="_webhook_action_attributes"></a>Webhook Action Attributes</h5><div class="informaltable"><a id="webhook-action-attributes"></a><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name                  </th><th align="center" valign="top">Required   </th><th align="center" valign="top"> Default     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">scheme</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>http</p></td><td align="left" valign="top"><p>The connection scheme. Valid values are: <code class="literal">http</code> or <code class="literal">https</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">host</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The host to connect to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">port</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The port the HTTP service is listening on.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">path</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The URL path. The path can be static text or include Mustache
                                                    <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>. URL query string parameters must be
                                                    specified via the <code class="literal">request.params</code> attribute.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">method</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>get</p></td><td align="left" valign="top"><p>The HTTP method. Valid values are: <code class="literal">head</code>, <code class="literal">get</code>, <code class="literal">post</code>, <code class="literal">put</code>
                                                    and <code class="literal">delete</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">headers</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The HTTP request headers. The header values can be static text
                                                    or include Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">params</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The URL query string parameters. The parameter values can be
                                                    static text or include Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">auth</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>Authentication related HTTP headers. Currently, only basic
                                                    authentication is supported.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">body</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The HTTP request body. The body can be static text or include
                                                    Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>. When not specified, an empty
                                                    body is sent.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.host</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The proxy host to use when connecting to the host.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.port</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The proxy port to use when connecting to the host.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">connection_timeout</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>10s</p></td><td align="left" valign="top"><p>The timeout for setting up the http connection. If the connection
                                                    could not be set up within this time, the action will timeout and
                                                    fail.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">read_timeout</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>10s</p></td><td align="left" valign="top"><p>The timeout for reading data from http connection. If no response
                                                    was received within this time, the action will timeout and fail.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">url</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>A shortcut for specifying the request scheme, host, port, and
                                                    path as a single string. For example, <code class="literal">http://example.org/foo/my-service</code>.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="actions-index"></a>Index Action</h3></div></div></div><p>A watch <a class="link" href="actions.html" title="Actions">Action</a> that enable you to index data in Elasticsearch.
See <a class="xref" href="actions.html#index-action-attributes" title="Index Action Attributes">the section called “Index Action Attributes”</a> for the supported attributes.</p><h5><a id="_configuring_index_actions"></a>Configuring Index Actions</h5><p>The following snippet shows a simple <code class="literal">index</code> action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "index_payload" : { <a id="CO58-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "transform": { ... }, <a id="CO58-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    "index" : {
      "index" : "my-index", <a id="CO58-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
      "doc_type" : "my-type" <a id="CO58-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO58-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The id of the action
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO58-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="transform.html" title="Transforms">transform</a> to transform the payload and prepare the data that should be indexed
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO58-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The elasticsearch index to store the data to
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO58-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The document type to store the data as
</p></td></tr></table></div><h5><a id="index-action-attributes"></a>Index Action Attributes</h5><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top">Name                     </th><th align="left" valign="top">Required    </th><th align="left" valign="top"> Default                </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">index</code></p></td><td align="left" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The Elasticsearch index to index into.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">doc_type</code></p></td><td align="left" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The type of the document the data will be indexed as.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">execution_time_field</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>_timestamp</p></td><td align="left" valign="top"><p>The field that will store/index the watch execution
                                                      time. When not set or when set to <code class="literal">_timestamp</code>, the
                                                      execution time will serve as the document’s
                                                      <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/mapping-timestamp-field.html" target="_top">timestamp</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">timeout</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>60s</p></td><td align="left" valign="top"><p>The timeout for waiting for the index api call to
                                                      return. If no response is returned within this time,
                                                      the index action times out and fails. This setting
                                                      overrides  the default  timeouts.</p></td></tr></tbody></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="anatomy-actions-index-multi-doc-support"></a>Multi-Document Support</h4></div></div></div><p>Like with all other actions, you can use a <a class="link" href="transform.html" title="Transforms">transform</a> to replace
the current execution context payload with another and by that change the document
that will end up indexed.</p><p>The index action plays well with transforms with its support for the special <code class="literal">_doc</code>
payload field.</p><p>When resolving the document to be indexed, the index action first looks up for a
<code class="literal">_doc</code> field in the payload. When not found, the payload is indexed as a single
document.</p><p>When a <code class="literal">_doc</code> field exists, if the field holds an object, it is extracted and indexed
as a single document. If the field holds an array of objects, each object is treated as
a document and the index aciton indexes all of them in a bulk.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="actions-logging"></a>Logging Action</h3></div></div></div><p>A watch <a class="link" href="actions.html" title="Actions">action</a> that simply logs text to the standard Elasticsearch
logs. See <a class="xref" href="actions.html#logging-action-attributes" title="Logging Action Attributes">the section called “Logging Action Attributes”</a> for the supported attributes.</p><p>This action is primarily used during development and for debugging purposes.</p><h5><a id="configuring-logging-actions"></a>Configuring Logging Actions</h5><p>You configure logging actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">logging</code> keyword.</p><p>The following snippet shows a simple logging action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "log" : { <a id="CO59-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "transform" : { ... }, <a id="CO59-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    "logging" : {
      "text" : "executed at {{ctx.execution_time}}" <a id="CO59-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO59-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The id of the action.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO59-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="transform.html" title="Transforms">transform</a> to transform the payload before
    executing the <code class="literal">logging</code> action.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO59-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The text to be logged.
</p></td></tr></table></div><h5><a id="logging-action-attributes"></a>Logging Action Attributes</h5><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name        </th><th align="left" valign="top">Required </th><th align="left" valign="top"> Default                       </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">text</code></p></td><td align="left" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The text that should be logged. Can be static text or
                                                          include Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">category</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>xpack.watcher.actions.logging</p></td><td align="left" valign="top"><p>The category under which the text will be logged.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">level</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>info</p></td><td align="left" valign="top"><p>The logging level. Valid values are: <code class="literal">error</code>, <code class="literal">warn</code>,
                                                          <code class="literal">info</code>, <code class="literal">debug</code> and <code class="literal">trace</code>.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="actions-hipchat"></a>HipChat Action</h3></div></div></div><p>A watch <a class="link" href="actions.html" title="Actions">action</a> that sends messages to <a class="ulink" href="https://www.hipchat.com" target="_top">HipChat</a>
rooms or users. To use the HipChat action, you need to configure at least one
HipChat account in Watcher. For information about configuring accounts, see
<a class="link" href="configuring-hipchat.html" title="Configuring HipChat">Configuring Watcher to Send Notifications to HipChat</a>.</p><h5><a id="configuring-hipchat-actions"></a>Configuring HipChat Actions</h5><p>You configure HipChat actions in a <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">hipchat</code> keyword. You must specify the <code class="literal">message</code>
attribute for all <code class="literal">hipchat</code> actions. If you omit the <code class="literal">account</code> attribute, the
message is sent using the default HipChat account configured in
<code class="literal">elasticsearch.yml</code>.</p><p>For example, the following action is configured to send messages using a HipChat
account that uses the <a class="link" href="configuring-hipchat.html#hipchat-api-integration" title="The HipChat Integration Profile">integration</a> profile. Because
this type of account can only send messages to a specific room, the only required
attribute is the message itself:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-hipchat" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "hipchat" : {
      "account" : "integration-account", <a id="CO60-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      "message" : {
        "body" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)", <a id="CO60-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        "format" : "text",
        "color" : "red",
        "notify" : true
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO60-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The name of a HipChat account configured in <code class="literal">elasticsearch.yml</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO60-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The message you want to send to HipChat.
</p></td></tr></table></div><p>To send messages with a HipChat account that uses the <a class="link" href="configuring-hipchat.html#hipchat-api-user" title="The HipChat User Profile">user</a>
profile, you need to specify what rooms and users you want to send the message to.
For example, the following action is configured to send messages to the
<code class="literal">mission-control</code> and <code class="literal">devops</code> rooms as well as the user <code class="literal">website-admin@example.com</code>.
(To send to multiple users or rooms, specify an array of strings):</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-hipchat" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "hipchat" : {
      "account" : "user-account",
      "message" : {
        "room" : [ "mission-control", "devops" ],
        "user" : "website-admin@example.com",
        "body" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)",
        "format" : "text",
        "color" : "red",
        "notify" : true
      }
    }
  }
}</pre></div><p>To send messages with a HipChat account that uses the <a class="link" href="configuring-hipchat.html#hipchat-api-v1" title="The HipChat v1 Profile">v1</a>
profile, you need to specify what room or rooms you want to send the message to.
For example, the following action is configured to send messages to the
<code class="literal">server-status</code> room. (To send to multiple rooms, specify an array of strings.)</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-hipchat" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "hipchat" : {
      "account" : "v1-account",
      "message" : {
        "from" : "Watcher",
        "room" : [ "server-status", "infra-team" ],
        "body" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)",
        "format" : "text",
        "color" : "red",
        "notify" : true
      }
    }
  }
}</pre></div><h5><a id="hipchat-action-attributes"></a>HipChat Action Attributes</h5><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name              </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Default         </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">account</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Default account</p></td><td align="left" valign="top"><p>The HipChat account to use to send the message.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.body</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The message content. Can contain up to 1000 characters.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.format</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>html</p></td><td align="left" valign="top"><p>The format of the message: <code class="literal">text</code> or <code class="literal">html</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.color</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>yellow</p></td><td align="left" valign="top"><p>The background color of the notification in the room:
                                                  <code class="literal">gray</code>, <code class="literal">green</code>, <code class="literal">purple</code>, <code class="literal">red</code>, <code class="literal">yellow</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.notify</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>Indicates whether people in the room should be actively
                                                  notified</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.from</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>the watch ID</p></td><td align="left" valign="top"><p>The name that appears as the notification sender. Only
                                                  valid for accounts that use the v1 profile.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.room</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The rooms that the notification should go to. Accepts
                                                  a string value or an array of string values. Must be
                                                  specified when using the v1 profile. At least one room
                                                  or user must be specified when using the <code class="literal">user</code> profile.
                                                  Not valid for the <code class="literal">integration</code> profile.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.user</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The users that the notification should go to. Accepts
                                                  a string value or an array of string values. At least
                                                  one room or user must be specified when using the <code class="literal">user</code>
                                                  profile. Not valid for the <code class="literal">integration</code> or <code class="literal">v1</code> profiles.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="actions-slack"></a>Slack Action</h3></div></div></div><p>A watch <a class="link" href="actions.html" title="Actions">action</a> that sends messages to a <a class="ulink" href="https://slack.com/" target="_top">Slack</a>
team’s channels or users. To use the Slack action, you need to configure at least
one Slack account in Watcher. For information about configuring accounts, see
<a class="link" href="configuring-slack.html" title="Configuring Slack">Configuring Watcher to Send Notifications to Slack</a>.</p><h5><a id="configuring-slack-actions"></a>Configuring Slack Actions</h5><p>You configure Slack actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">slack</code> keyword.</p><p>The following snippet shows a simple slack action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-slack" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "slack" : {
      "to" : [ "#admins", "@chief-admin" ], <a id="CO61-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      "message" : {
        "text" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)" <a id="CO61-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO61-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The channels and users you want to send the message to.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO61-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The content of the message.
</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="formatting-slack-messages"></a>Using Attachments to Format Slack Messages</h4></div></div></div><p>In addition to sending simple text-based messages, you can use the Slack
<a class="ulink" href="https://api.slack.com/docs/attachments" target="_top">attachment</a> mechanism to send formatted
messages. Watcher leverages Slack attachments to enable you to dynamically
populate templated messages from the execution context payload.</p><p>The following snippet shows a standard message attachment:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-slack" : {
    "throttle_period" : "5m",
    "slack" : {
      "account" : "team1",
      "message" : {
        "from" : "watcher",
        "to" : [ "#admins", "@chief-admin" ],
        "text" : "System X Monitoring",
        "attachments" : [
          {
            "title" : "Errors Found",
            "text" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)",
            "color" : "danger"
          }
        ]
      }
    }
  }
}</pre></div><p><a id="slack-dynamic-attachment"></a>To define an attachment template that is dynamically populated from the payload,
you specify <code class="literal">dynamic_attachments</code> in the watch action. For example, a dynamic
attachment could reference histogram buckets in the payload and build an
attachment per bucket.</p><p>In the following example, the watch input executes a search with a date histogram
aggregation and the Slack action:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Transforms the payload to a list where each item in the list holds the month,
  the user count for that month, and the color that represents the sentiment
  associated with that count (danger or bad).
</li><li class="listitem">
Defines an attachment template that references items in the list generated by
  the transform.
</li></ol></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"input" : {
  "search" : {
    "request" : {
      "body" : {
        "aggs" : {
          "users_per_month" : {
            "date_histogram" : {
              "field" : "@timestamp",
              "interval" : "month"
            }
          }
        }
      }
    }
  }
},
...
"actions" : {
  "notify-slack" : {
    "throttle_period" : "5m",
    "transform" : {
      "script" : {
        "inline" : "def items = new ArrayList(); for (int i = 0; i &lt; ctx.payload.aggregations.users_per_month.buckets.size(); i++) { def bucket = ctx.payload.aggregations.users_per_month.buckets[i]; def item = new HashMap(); item.count = bucket.doc_count; item.name = bucket.key_as_string; item.color = bucket.doc_count &lt; 100 ? 'danger' : 'good'; items.add(item); } return items;",
        "lang" : "painless"
      }
    },
    "slack" : {
      "account" : "team1",
      "message" : {
        "from" : "watcher",
        "to" : [ "#admins", "@chief-admin" ],
        "text" : "System X Monitoring",
        "dynamic_attachments" : {
          "list_path" : "ctx.payload.items" <a id="CO62-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
          "attachment_template" : {
            "title" : "{{month}}", <a id="CO62-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
            "text" : "Users Count: {{count}}",
            "color" : "{{color}}"
          }
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO62-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The list generated by the action’s transform.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO62-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The parameter placeholders refer to attributes in each item of the list
    generated by the transform.
</p></td></tr></table></div><h5><a id="slack-action-attributes"></a>Slack Action Attributes</h5><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name                  </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">from</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The sender name to display in the  Slack message.
                                    Overrides the incoming webhook’s configured name.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">to</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>The channels and users you want to send the message
                                    to. Channel names must start with <code class="literal">#</code> and user names
                                    must start with <code class="literal">@</code>. Accepts a string value or an
                                    array of string values.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">icon</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The icon to display in the Slack messages. Overrides
                                    the incoming webhook’s configured icon. Accepts a
                                    public URL to an image.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">text</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>The message content.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attachments</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Slack message attachments. Message attachments enable
                                    you to create more richly-formatted messages. Specified
                                    array as defined in the
                                    <a class="ulink" href="https://api.slack.com/docs/attachments" target="_top">Slack attachments documentation</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">dynamic_attachments</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Slack message attachments that can be populated
                                    dynamically based on the current watch payload. For
                                    more information, see
                                    <a class="link" href="actions.html#slack-dynamic-attachment">Using Attachments to Format Slack Messages</a>.</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="actions-pagerduty"></a>PagerDuty Action</h3></div></div></div><p>A watch <a class="link" href="actions.html" title="Actions">action</a> that creates events in <a class="ulink" href="https://pagerduty.com/" target="_top">PagerDuty</a>.
To use the PagerDuty action, you need to configure at least one PagerDuty account
in Watcher.</p><h5><a id="configuring-pagerduty-actions"></a>Configuring PagerDuty Actions</h5><p>You configure PagerDuty actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">pagerduty</code> keyword.</p><p>The following snippet shows a simple slack action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-pagerduty" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "pagerduty" : {
      "description" : "Main system down, please check!" <a id="CO63-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO63-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Description of the message
</p></td></tr></table></div><h5><a id="adding-context-and-payloads-to-pagerduty-actions"></a>Adding Meta Information to a PagerDuty Incident</h5><p>In order to give the pagerduty incident some more context, you can attach the
payload as well as an array of contexts to the action.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-pagerduty" : {
    "throttle_period" : "5m",
    "pagerduty" : {
      "account" : "team1",
      "description" : "Main system down, please check! Happened at {{ctx.execution_time}}"
      "attach_payload" : true,
      "client" : "/foo/bar/{{ctx.watch_id}}",
      "client_url" : "http://www.example.org/",
      "context" : [
        {
          "type": "link",
          "href": "http://acme.pagerduty.com"
        },{
          "type": "link",
          "href": "http://acme.pagerduty.com",
          "text": "View the incident on {{ctx.payload.link}}"
        }
      ]
    }
  }
}</pre></div><h5><a id="pagerduty-action-attributes"></a>Pagerduty Action Attributes</h5><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name        </th><th align="center" valign="top">Required   </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">account</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The account to use, falls back to the default one.
                            The account needs a <code class="literal">service_key_api</code> attribute.</p></td></tr></tbody></table></div><div class="table"><a id="pagerduty-event-trigger-incident-attributes"></a><p class="title"><strong>Table 35. Pagerduty Event Trigger Incident Attributes</strong></p><div class="table-contents"><table summary="Pagerduty Event Trigger Incident Attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name              </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">description</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>A quick description for this event</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">event_type</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The event type to sent. Must be one of <code class="literal">trigger</code>,
                                <code class="literal">resolve</code> or <code class="literal">acknowledge</code>. Defaults to <code class="literal">trigger</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">incident_key</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The incident key on the pagerduty side, also used
                                for de-duplication and allows to resolve or acknowledge
                                incidents.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">client</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Name of the client triggering the incident, i.e.
                                <code class="literal">Watcher Monitoring</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">client_url</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>A client URL to visit to get more detailed information.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attach_payload</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code> the payload is attached as a detail
                                to the API call. Defaults to <code class="literal">false</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">contexts</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>An array of objects, that allow you to provide
                                additional links or images in order to provide more
                                context to the trigger.</p></td></tr></tbody></table></div></div><br class="table-break" /><p>You can configure defaults for the above values for the whole service using the
<code class="literal">xpack.notification.pagerduty.service.event_defaults.*</code> properties as well as
per account using <code class="literal">xpack.notification.pagerduty.service.account.your_account_name.event_defaults.*</code></p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>All of those objects have templating support, so you can use data from the
      context and the payload as part of all the fields.</p></div></div><div class="table"><a id="pagerduty-event-trigger-context-attributes"></a><p class="title"><strong>Table 36. Pagerduty Event Trigger Context Attributes</strong></p><div class="table-contents"><table summary="Pagerduty Event Trigger Context Attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name    </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">type</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>One of <code class="literal">link</code> or <code class="literal">image</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">href</code></p></td><td align="center" valign="top"><p>yes/no</p></td><td align="left" valign="top"><p>A link to include more information. Must be there if the
                      type is <code class="literal">link</code>, optional if the type is <code class="literal">image</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">src</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>A src attribute for the <code class="literal">image</code> type.</p></td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="navfooter"><span class="prev"><a href="condition.html">
              « 
              Conditions</a>
           
        </span><span class="next">
           
          <a href="transform.html">Transforms
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        