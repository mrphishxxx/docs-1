<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Transforms
        | X-Pack for the Elastic Stack
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="X-Pack for the Elastic Stack" /><link rel="up" href="watcher-reference.html" title="Reference" /><link rel="prev" href="actions.html" title="Actions" /><link rel="next" href="api-java.html" title="Java API" /><meta name="DC.type" content="Docs/XPack/Reference" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b> These docs are for a pre-GA version of X-Pack, 5.0.0-alpha3.</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">X-Pack for the Elastic Stack</a></span> » <span class="breadcrumb-link"><a href="xpack-alerting.html">Watcher - Alerting &amp; Notification </a></span> » <span class="breadcrumb-link"><a href="watcher-reference.html">Reference</a></span> » <span class="breadcrumb-node">Transforms</span></div><div class="navheader"><span class="prev"><a href="actions.html">
              « 
              Actions</a>
           
        </span><span class="next">
           
          <a href="api-java.html">Java API
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="transform"></a>Transforms</h2></div></div></div><p>A <span class="emphasis"><em>Transform</em></span> processes and changes the payload in the watch execution context
to prepare it for the watch actions.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Transforms are optional. When none are defined, the actions have access to
      the payload as loaded by the watch input.</p></div></div><p>You can define transforms in two places:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
As a top level construct in the watch definition. In this case, the payload is
  transformed before any of the watch actions are executed.
</li><li class="listitem">
As part of the definition of an action. In this case, the payload is
  transformed before that action is executed. The transformation is only applied
  to the payload for that specific action.
</li></ul></div><p>If all actions require the same view of the payload, define a transform as part
of the watch definition. If each action requires a different view of the payload,
define different transforms as part of the action definitions so each action has
the payload prepared by its own dedicated transform.</p><p>The following example defines two transforms, one at the watch level and one as
part of the definition of the <code class="literal">my_webhook</code> action.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "trigger" : { ...}
  "input" : { ... },
  "condition" : { ... },
  "transform" : { <a id="CO64-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "search" : {
      "body" : { "query" : { "match_all" : {} } }
    }
  },
  "actions" : {
    "my_webhook": {
      "transform" : { <a id="CO64-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        "script" : "return ctx.payload.hits"
      },
      "webhook" : {
        "host" : "host.domain",
        "port" : 8089,
        "path" : "/notify/{{ctx.watch_id}}"
      }
    }
  ]
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO64-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
A watch level <code class="literal">transform</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO64-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An action level <code class="literal">transform</code>
</p></td></tr></table></div><p>Watcher supports three types of transforms: <a class="link" href="transform.html#transform-search" title="Search Transform"><code class="literal">search</code></a>,
<a class="link" href="transform.html#transform-script" title="Script Transform"><code class="literal">script</code></a> and <a class="link" href="transform.html#transform-chain" title="Chain Transform"><code class="literal">chain</code></a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transform-search"></a>Search Transform</h3></div></div></div><p>A <a class="link" href="transform.html" title="Transforms">Transform</a> that executes a search on the cluster and replaces
the current payload in the watch execution context with the returned search
response. The following snippet shows how a simple search transform can be
defined on the watch level:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "transform" : {
    "search" : {
      "request" : {
        "body" : { "query" : { "match_all" : {} }}
      }
    }
  }
}</pre></div><p>Like every other search based construct, one can make use of the full search
API supported by Elasticsearch. For example, the following search transform
execute a search over all events indices, matching events with <code class="literal">error</code> priority:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "transform" : {
    "search" : {
      "request" : {
        "indices" : [ "events-*" ],
        "body" : {
          "size" : 0,
          "query" : {
            "match" : { "priority" : "error"}
          }
        }
      }
    }
  }
}</pre></div><p>The following table lists all available settings for the search transform:</p><div class="table"><a id="transform-search-settings"></a><p class="title"><strong>Table 37. Search Transform Settings</strong></p><div class="table-contents"><table summary="Search Transform Settings" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name                                          </th><th align="center" valign="top">Required   </th><th align="left" valign="top"> Default           </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">request.search_type</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>query_then_fetch</p></td><td align="left" valign="top"><p>The search <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/search-request-search-type.html" target="_top">type</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.indices</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>all indices</p></td><td align="left" valign="top"><p>One or more indices to search on.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.types</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>all types</p></td><td align="left" valign="top"><p>One or more document types to search on (may be a
                                                                                  comma-delimited string or an array of document types
                                                                                  names)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.body</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p><code class="literal">match_all</code> query</p></td><td align="left" valign="top"><p>The body of the request. The
                                                                                  <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/search-request-body.html" target="_top">request body</a> follows
                                                                                  the same structure you normally send in the body of
                                                                                  a REST <code class="literal">_search</code> request. The body can be static text
                                                                                  or include <code class="literal">mustache</code> <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.indices_options.expand_wildcards</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p><code class="literal">open</code></p></td><td align="left" valign="top"><p>Determines how to expand indices wildcards. Can be one
                                                                                  of <code class="literal">open</code>, <code class="literal">closed</code>, <code class="literal">none</code> or <code class="literal">all</code>
                                                                                  (see <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/multi-index.html" target="_top">multi-index support</a>)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.indices_options.ignore_unavailable</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p>A boolean value that determines whether the search
                                                                                  should leniently ignore unavailable indices
                                                                                  (see <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/multi-index.html" target="_top">multi-index support</a>)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.indices_options.allow_no_indices</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td><td align="left" valign="top"><p>A boolean value that determines whether the search
                                                                                  should leniently return no results when no indices
                                                                                  are resolved (see <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/multi-index.html" target="_top">multi-index support</a>)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.template</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The body of the search template. See
                                                                                  <a class="link" href="how-watcher-works.html#templates" title="Using Templates">configure templates</a> for more information.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">timeout</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>30s</p></td><td align="left" valign="top"><p>The timeout for waiting for the search api call to
                                                                                  return. If no response is returned within this time,
                                                                                  the search transform times out and fails. This setting
                                                                                  overrides the default timeouts.</p></td></tr></tbody></table></div></div><br class="table-break" /><h5><a id="transform-search-template"></a>Template Support</h5><p>The search transform support mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templates">templates</a>. This can either
be as part of the body definition, or alternatively, point to an existing
template (either defined in a file or <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/search-template.html#pre-registered-templates" target="_top">registered</a>
as a script in Elasticsearch).</p><p>For example, the following snippet shows a search that refers to the scheduled
time of the watch:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "transform" : {
    "search" : {
      "request" : {
        "indices" : [ "logstash-*" ],
        "types" : [ "event" ],
        "body" : {
          "size" : 0,
          "query" : {
            "bool" : {
              "must" : {
                "match" : { "priority" : "error"}
              },
              "filter" : [
                {
                  "range" : {
                    "@timestamp" : {
                      "from" : "{{ctx.trigger.scheduled_time}}||-30s",
                      "to" : "{{ctx.trigger.triggered_time}}"
                    }
                  }
                }
              ]
            }
          }
        }
      }
    }
  }
}</pre></div><p>The model of the template is a union between the provided <code class="literal">template.params</code>
settings and the <a class="link" href="how-watcher-works.html#watch-execution-context" title="Watch Execution Context">standard watch execution context model</a>.</p><p>The following is an example of using templates that refer to provided parameters:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "transform" : {
    "search" : {
      "request" : {
        "indices" : [ "logstash-*" ],
        "types" : [ "event" ],
        "template" : {
          "inline" : {
            "size" : 0,
            "query" : {
              "bool" : {
                "must" : {
                  "match" : { "priority" : "{{priority}}"}
                },
                "filter" : [
                  {
                    "range" : {
                      "@timestamp" : {
                        "from" : "{{ctx.trigger.scheduled_time}}||-30s",
                        "to" : "{{ctx.trigger.triggered_time}}"
                      }
                    }
                  }
                ]
              }
            },
            "params" : {
              "priority" : "error"
            }
          }
        }
      }
    }
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transform-script"></a>Script Transform</h3></div></div></div><p>A <a class="link" href="transform.html" title="Transforms">Transform</a> that executes a script on the current payload in the
watch execution context and replaces it with a newly generated one. The following
snippet shows how a simple script transform can be defined on the watch level:</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>The <code class="literal">script</code> transform is often useful when used in combination with the
      <a class="link" href="transform.html#transform-search" title="Search Transform"><code class="literal">search</code></a> transform, where the script can extract only
      the significant data from a search result, and by that, keep the payload
      minimal. This can be achieved with the <a class="link" href="transform.html#transform-chain" title="Chain Transform"><code class="literal">chain</code></a>
      transform.</p></div></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "transform" : {
    "script" : "return [ time : ctx.trigger.scheduled_time ]" <a id="CO65-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO65-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
A simple <code class="literal">groovy</code> script that creates a new payload with a single <code class="literal">time</code>
    field holding the scheduled time.
</p></td></tr></table></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The executed script may either return a valid model that is the equivalent
      of a Java™ Map or a JSON object (you will need to consult the
      documentation of the specific scripting language to find out what this
      construct is). Any other value that is returned will be assigned and
      accessible to/via the <code class="literal">_value</code> variable.</p></div></div><p>The <code class="literal">script</code> attribute may hold a string value in which case it will be treated
as an inline script and the default elasticsearch script languages will be assumed
(as described in <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting.html#modules-scripting" target="_top">here</a>). You can
use the other scripting languages supported by Elasticsearch. For this, you need
to set the <code class="literal">script</code> field to an object describing the script and its language.
The following table lists the possible settings that can be configured:</p><div class="table"><a id="transform-script-settings"></a><p class="title"><strong>Table 38. Script Transform Settings</strong></p><div class="table-contents"><table summary="Script Transform Settings" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name      </th><th align="left" valign="top">Required </th><th align="left" valign="top"> Default   </th><th align="left" valign="top"> Description</th></tr></thead><tfoot><tr><th colspan="4" align="left" valign="top"><p>* When using the object notation, only one of <code class="literal">inline</code>, <code class="literal">file</code> or <code class="literal">id</code>
       fields must be defined</p></th></tr></tfoot><tbody><tr><td align="left" valign="top"><p><code class="literal">inline</code></p></td><td align="left" valign="top"><p>yes*</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>When using an inline script, this field holds
                                    the script itself.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">file</code></p></td><td align="left" valign="top"><p>yes*</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>When referring to a script file, this field
                                    holds the name of the file.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">id</code></p></td><td align="left" valign="top"><p>yes*</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>When referring to a stored script, this
                                    field holds the id of the script.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">lang</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p><code class="literal">groovy</code></p></td><td align="left" valign="top"><p>The script language</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">params</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>Additional parameters/variables that are
                                    accessible by the script</p></td></tr></tbody></table></div></div><br class="table-break" /><p>When using the object notation of the script, one (and only one) of <code class="literal">inline</code>,
<code class="literal">file</code> or <code class="literal">id</code> fields must be defined</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>In addition to the provided <code class="literal">params</code>, the scripts also have access to the
      <a class="link" href="how-watcher-works.html#watch-execution-context" title="Watch Execution Context">Standard Watch Execution Context Parameters</a>.</p></div></div><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>For Groovy, you must explicitly <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting-security.html#enable-dynamic-scripting" target="_top">enable dynamic scripts</a>
in <code class="literal">elasticsearch.yml</code> to use <code class="literal">inline</code> or <code class="literal">stored</code> scripts.  To enable groovy
scripting for watches only, you can set <code class="literal">script.engine.groovy.inline.xpack_watch: true</code>.</p><p>Alternatively, starting with 5.0, Elasticsearch is shipped with the new
<a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting-painless.html" target="_top">Painless</a> scripting language. Painless was
created and designed specifically for use in Elasticsearch. Beyond providing an
extensive feature set, its biggest trait is that it’s properly sandboxed and safe
to use anywhere in the system (including in Watcher) without the need to enable
dynamic scripting.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transform-chain"></a>Chain Transform</h3></div></div></div><p>A <a class="link" href="transform.html" title="Transforms">Transform</a> that executes an ordered list of configured transforms
in a chain, where the output of one transform serves as the input of the next
transform in the chain. The payload that is accepted by this transform serves as
the input of the first transform in the chain and the output of the last transform
in the chain is the output of the <code class="literal">chain</code> transform as a whole.</p><p>You can use chain transforms to build more complex transforms out of the other
available transforms. For example, you can combine a <a class="link" href="transform.html#transform-search" title="Search Transform"><code class="literal">search</code></a>
transform and a <a class="link" href="transform.html#transform-script" title="Script Transform"><code class="literal">script</code></a> transform, as shown in the
following snippet:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"transform" : {
  "chain" : [ <a id="CO66-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    {
      "search" : {  <a id="CO66-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        "indices" : [ "logstash-*" ],
        "body" : {
          "size" : 0,
          "query" : {
            "match" : { "priority" : "error" }
          }
        }
      }
    },
    {
      "script" : "return [ error_count : ctx.payload.hits.total ]"  <a id="CO66-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
    }
  ]
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO66-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">chain</code> transform definition
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO66-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The first transform in the chain (in this case, a <code class="literal">search</code> transform)
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO66-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The second and final transform in the chain (in this case, a <code class="literal">script</code>
    transform)
</p></td></tr></table></div><p>This example executes a <code class="literal">count</code> search on the cluster to look for <code class="literal">error</code> events.
The search results are then passed to the second <code class="literal">script</code> transform. The <code class="literal">script</code>
transform extracts the total hit count and assigns it to the <code class="literal">error_count</code> field
in a newly-generated payload. This new payload is the output of the <code class="literal">chain</code>
transform and replaces the payload in the watch execution context.</p></div></div><div class="navfooter"><span class="prev"><a href="actions.html">
              « 
              Actions</a>
           
        </span><span class="next">
           
          <a href="api-java.html">Java API
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        