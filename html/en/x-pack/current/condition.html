<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Conditions
        | X-Pack for the Elastic Stack
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="X-Pack for the Elastic Stack" /><link rel="up" href="watcher-reference.html" title="Reference" /><link rel="prev" href="trigger.html" title="Triggers" /><link rel="next" href="actions.html" title="Actions" /><meta name="DC.type" content="Docs/XPack/Reference" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b> These docs are for a pre-GA version of X-Pack, 5.0.0-alpha3.</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">X-Pack for the Elastic Stack</a></span> » <span class="breadcrumb-link"><a href="xpack-alerting.html">Watcher - Alerting &amp; Notification </a></span> » <span class="breadcrumb-link"><a href="watcher-reference.html">Reference</a></span> » <span class="breadcrumb-node">Conditions</span></div><div class="navheader"><span class="prev"><a href="trigger.html">
              « 
              Triggers</a>
           
        </span><span class="next">
           
          <a href="actions.html">Actions
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="condition"></a>Conditions</h2></div></div></div><p>When a watch is triggered, its condition determines whether or not to execute
its actions. Watcher supports four condition types: <a class="link" href="condition.html#condition-always" title="Always Condition"><code class="literal">always</code></a>,
<a class="link" href="condition.html#condition-never" title="Never Condition"><code class="literal">never</code></a>, <a class="link" href="condition.html#condition-script" title="Script Condition"><code class="literal">script</code></a> and
<a class="link" href="condition.html#condition-compare" title="Compare Condition"><code class="literal">compare</code></a>.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If you omit the condition definition from a watch, the condition defaults
      to <code class="literal">always</code>.</p></div></div><p>When a condition is evaluated, it has full access to the watch execution context,
including the watch payload (<code class="literal">ctx.payload.*</code>). The <a class="link" href="condition.html#condition-script" title="Script Condition">script</a>,
<a class="link" href="condition.html#condition-compare" title="Compare Condition">compare</a>  and <a class="link" href="condition.html#condition-array-compare" title="Array Compare Condition">array-compare</a>
conditions can use the payload data to determine whether or not the necessary
conditions are met.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="condition-always"></a>Always Condition</h3></div></div></div><p>A watch <a class="link" href="condition.html" title="Conditions">condition</a> that always evaluates to <code class="literal">true</code>. When you use
the <code class="literal">always</code> condition, the actions in the watch are always executed when it is
triggered, unless the action is <a class="link" href="actions.html#actions-ack-throttle" title="Acknowledgement and Throttling">throttled</a>.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If you omit the condition definition from a watch, the condition defaults
      to <code class="literal">always</code>.</p></div></div><p>You can use the <code class="literal">always</code> condition to configure watches that should always
execute on a set schedule, such as:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-text">"Every Friday at noon, send a status report email to sys.admin@example.com"</pre></div><p>To configure this watch, you define an input that loads the status data, set a
schedule that triggers every Friday, set the condition to <code class="literal">always</code>, and configure
an email action to send the status data.</p><h5><a id="_using_the_always_condition"></a>Using the Always Condition</h5><p>There are no attributes to specify for the <code class="literal">always</code> condition. To use the this
condition, you just specify the condition type and associate it with an empty
object:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"condition" : {
  "always" : {}
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="condition-never"></a>Never Condition</h3></div></div></div><p>A watch <a class="link" href="condition.html" title="Conditions">condition</a> that always evaluates to <code class="literal">false</code>. If you use
this condition, the actions of the watch are never executed. The watch input is
executed, a record is added to the watch history, and the watch execution ends.
This condition is generally used for testing.</p><h5><a id="_using_the_never_condition"></a>Using the Never Condition</h5><p>There are no attributes to specify for the <code class="literal">never</code> condition. To use the it,
you specify the condition type and associate it with an empty object:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT _xpack/watcher/watch/my-watch
{
  "condition" : {
    "never" : {}
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="condition-script"></a>Script Condition</h3></div></div></div><p>A watch <a class="link" href="condition.html" title="Conditions">condition</a> that evaluates a script. The default scripting
language is <code class="literal">groovy</code>. You can use any of the scripting languages supported by
Elasticsearch as long as the language supports evaluating expressions to Boolean
values. Note that the <code class="literal">mustache</code> and <code class="literal">expression</code> languages are too limited to be
used by this condition. For more information, see <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting.html" target="_top">Scripting</a>
in the Elasticsearch Reference.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>For Groovy, you must explicitly <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting-security.html#enable-dynamic-scripting" target="_top">enable dynamic scripts</a>
in <code class="literal">elasticsearch.yml</code> to use <code class="literal">inline</code> or <code class="literal">stored</code> scripts.  To enable groovy
scripting for watches only, you can set <code class="literal">script.engine.groovy.inline.xpack_watch: true</code>.</p><p>Alternatively, starting with 5.0, Elasticsearch is shipped with the new
<a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting-painless.html" target="_top">Painless</a> scripting language. Painless was
created and designed specifically for use in Elasticsearch. Beyond providing an
extensive feature set, its biggest trait is that it’s properly sandboxed and safe
to use anywhere in the system (including in Watcher) without the need to enable
dynamic scripting.</p></div></div><h5><a id="_using_a_script_condition"></a>Using a Script Condition</h5><p>The following snippet configures an inline <code class="literal">script</code> condition that always returns
<code class="literal">true</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"condition" : {
  "script" : "return true"
}</pre></div><p>This example defines a script as a simple string. This format is actually a
shortcut for defining an <a class="link" href="condition.html#condition-script-inline" title="Inline Scripts">inline</a> groovy script. The
formal definition of a script is an object that specifies the script type and
optional language and parameter values. If the <code class="literal">lang</code> attribute is omitted, the
language defaults to groovy. Elasticsearch supports three script types:
<a class="link" href="condition.html#condition-script-inline" title="Inline Scripts">Inline</a>, <a class="link" href="condition.html#condition-script-file" title="File Scripts">File</a>, and
<a class="link" href="condition.html#condition-script-stored" title="Stored Scripts">Stored</a>.</p><p>For example, the following snippet shows a formal definition of an <code class="literal">inline</code>
script that explicitly specifies the language and defines a single script
parameter, <code class="literal">result</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"condition" : {
  "script" : {
    "inline" : "return result",
    "lang" : "groovy",
    "params" : {
      "result" : true
    }
  }
}</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="condition-script-inline"></a>Inline Scripts</h4></div></div></div><p>Inline scripts are scripts that are defined in the condition itself. The
following snippet shows the formal configuration of a simple groovy script that
always returns <code class="literal">true</code>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"condition" : {
  "script" : {
    "inline" : "return true"
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="condition-script-file"></a>File Scripts</h4></div></div></div><p>File scripts are scripts that are defined in files stored in the <code class="literal">config/scripts</code>
directory. The following snippet shows how to refer to the <code class="literal">my_script.groovy</code>
file:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"condition" : {
  "script" : {
    "file" : "my_script"
  }
}</pre></div><p>As with <a class="link" href="condition.html#condition-script-inline" title="Inline Scripts">Inline</a> scripts, you can also specify the
script language and parameters:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"condition" : {
  "script" : {
    "file" : "my_script",
    "lang" : "javascript",
    "params" : {
      "result" : true
    }
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="condition-script-stored"></a>Stored Scripts</h4></div></div></div><p>Stored scripts refer to scripts that were <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/master/modules-scripting-using.html#modules-scripting-stored-scripts" target="_top">stored</a>
in Elasticsearch. The following snippet shows how to refer to a script by its <code class="literal">id</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"condition" : {
  "script" : {
    "id" : "my_script"
  }
}</pre></div><p>As with <a class="link" href="condition.html#condition-script-file" title="File Scripts">File</a> and <a class="link" href="condition.html#condition-script-inline" title="Inline Scripts">Inline</a>
scripts, you can also specify the script language and parameters:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"condition" : {
  "script" : {
    "id" : "my_script",
    "lang" : "javascript",
    "params" : { "color" : "red" }
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="accessing-watch-payload"></a>Accessing the Watch Payload</h4></div></div></div><p>A script can access the current watch execution context, including the payload
data, as well as any parameters passed in through the condition definition.</p><p>For example, the following snippet defines a watch that uses a <a class="link" href="input.html#input-search" title="Search Input"><code class="literal">search</code> input</a>
and uses a <code class="literal">script</code> condition to check if the number of hits is above a specified
threshold:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "input" : {
    "search" : {
      "indices" : "log-events",
      "body" : {
        "size" : 0,
        "query" : { "match" : { "status" : "error" } }
      }
    }
  },
  "condition" : {
    "script" : {
      "inline" : "return ctx.payload.hits.total &gt; threshold",
      "params" : {
        "threshold" : 5
      }
    }
  }
}</pre></div><p>When you’re using a scripted condition to evaluate an Elasticsearch response,
keep in mind that the fields in the response are no longer in their native data
types. For example, the <code class="literal">@timestamp</code> in the response is a string, rather than a
<code class="literal">DateTime</code>. To compare the response <code class="literal">@timestamp</code> against the <code class="literal">ctx.execution_time</code>,
you need to parse the <code class="literal">@timestamp</code> string into a <code class="literal">DateTime</code>. For example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">org.elasticsearch.common.joda.time.DateTime.parse(@timestamp)</pre></div><p>You can reference the following variables in the watch context:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name                          </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">ctx.watch_id</code></p></td><td align="left" valign="top"><p>The id of the watch that is currently executing.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.execution_time</code></p></td><td align="left" valign="top"><p>The time execution of this watch started.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.trigger.triggered_time</code></p></td><td align="left" valign="top"><p>The time this watch was triggered.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.trigger.scheduled_time</code></p></td><td align="left" valign="top"><p>The time this watch was supposed to be triggered.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.metadata.*</code></p></td><td align="left" valign="top"><p>Any metadata associated with the watch.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.payload.*</code></p></td><td align="left" valign="top"><p>The payload data loaded by the watch’s input.</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="condition-compare"></a>Compare Condition</h3></div></div></div><p>A watch <a class="link" href="condition.html" title="Conditions">condition</a> that simply compares a value in the
<a class="link" href="how-watcher-works.html#watch-execution-context" title="Watch Execution Context">Watch Execution Context Model</a> to given value. The
value in the model is identified by a path within that model.</p><p>While limited in its functionality, the advantage of this condition over the
<a class="link" href="condition.html#condition-script" title="Script Condition">Script Condition</a> is that you do not have to enable dynamic
scripting to use it.</p><h5><a id="_using_a_compare_condition"></a>Using a Compare Condition</h5><p>The following snippet configures a <code class="literal">compare</code> condition that returns <code class="literal">true</code> if
the number of the total hits in the search result (typically loaded by the
<a class="link" href="input.html#input-search" title="Search Input">Search Input</a>) is higher or equals 5:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "condition" : {
    "compare" : {
      "ctx.payload.hits.total" : { <a id="CO48-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        "gte" : 5 <a id="CO48-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
      }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The field name is the path to the execution context model
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The field name (here <code class="literal">gte</code>) is the comparison operator, and the value is the
    value to compare to.
</p></td></tr></table></div><p>The path is a "dot-notation" expression that can reference the following variables
in the watch context:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name                         </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">ctx.watch_id</code></p></td><td align="left" valign="top"><p>The id of the watch that is currently executing.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.execution_time</code></p></td><td align="left" valign="top"><p>The time execution of this watch started.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.trigger.triggered_time</code></p></td><td align="left" valign="top"><p>The time this watch was triggered.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.trigger.scheduled_time</code></p></td><td align="left" valign="top"><p>The time this watch was supposed to be triggered.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.metadata.*</code></p></td><td align="left" valign="top"><p>Any metadata associated with the watch.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.payload.*</code></p></td><td align="left" valign="top"><p>The payload data loaded by the watch’s input.</p></td></tr></tbody></table></div><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>You can reference entries in arrays using their zero-based array indices.
      For example, to access the third element of the <code class="literal">ctx.payload.hits.hits</code>
      array, use <code class="literal">ctx.payload.hits.hits.2</code>.</p></div></div><p><a id="condition-compare-operators"></a>The comparison operator can be any one of the following:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name      </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">eq</code></p></td><td align="left" valign="top"><p>Returns <code class="literal">true</code> when the resolved value equals the given one (applies
              to numeric, string, list, object and values)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">not_eq</code></p></td><td align="left" valign="top"><p>Returns <code class="literal">true</code> when the resolved value does not equal the given one
              (applies to numeric, string, list, object and null values)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">gt</code></p></td><td align="left" valign="top"><p>Returns <code class="literal">true</code> when the resolved value is greater than the given
              one (applies to numeric and string values)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">gte</code></p></td><td align="left" valign="top"><p>Returns <code class="literal">true</code> when the resolved value is greater/equal than/to the
              given one (applies to numeric and string values)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">lt</code></p></td><td align="left" valign="top"><p>Returns <code class="literal">true</code> when the resolved value is less than the given one
              (applies to numeric and string values)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">lte</code></p></td><td align="left" valign="top"><p>Returns <code class="literal">true</code> when the resolved value is less/equal than/to the
              given one (applies to numeric and string values)</p></td></tr></tbody></table></div><p>When dealing with dates/times, the specified value can hold date math expression
in the form of <code class="literal">&lt;{expression}&gt;</code>. For example, one can compare the watch execution
time as follows:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "condition" : {
    "compare" : {
      "ctx.execution_time" : {
        "gte" : "&lt;{now-5m}&gt;"
      }
  }
}</pre></div><p>It is also possible to compare one value in the context model to another value
in the same model. This can be done by specifying the compared value as a path
in the form of <code class="literal">{{path}}</code>. For example, the following snippet shows a condition
that compares two values in the payload:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "condition" : {
    "compare" : {
      "ctx.payload.aggregations.status.buckets.error.doc_count" : {
        "not_eq" : "{{ctx.payload.aggregations.handled.buckets.true.doc_count}}"
      }
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="condition-array-compare"></a>Array Compare Condition</h3></div></div></div><p>A watch <a class="link" href="condition.html" title="Conditions">condition</a> that compares an array of values in the
<a class="link" href="how-watcher-works.html#watch-execution-context" title="Watch Execution Context">Watch Execution Context Model</a> to a given value. The
values in the model are identified by a path within that model.</p><h4><a id="_using_an_array_compare_condition"></a>Using an Array Compare Condition</h4><p>The following snippet configures an <code class="literal">array_compare</code> condition that returns <code class="literal">true</code>
if there is at least one bucket in the aggregation that has a <code class="literal">doc_count</code> higher
than or equal to 25:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "condition": {
    "array_compare": {
      "ctx.payload.aggregations.top_tweeters.buckets" : { <a id="CO49-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        "path": "doc_count" <a id="CO49-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>,
        "gte": { <a id="CO49-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
          "value": 25, <a id="CO49-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
          "quantifier": "some" <a id="CO49-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The field name is the path to the array (array path) in the execution
    context model.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The value of the field <code class="literal">path</code> (here <code class="literal">doc_count</code>) is the path to the value
    for each element of the array that the comparison operator will be applied to
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The field name (here <code class="literal">gte</code>) is the name of the comparison operator
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The value of the field <code class="literal">value</code> in the comparison operator object is the
    comparison value
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The value of the field <code class="literal">quantifier</code> (<code class="literal">all</code> or <code class="literal">some</code>) specifies whether the
    comparison must be true for all or for at least one of the values to evaluate
    the comparison to true
</p></td></tr></table></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">path</code> element is optional and will default to <code class="literal">""</code> if not specified.</p></div></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">quantifier</code> element is optional and will default to <code class="literal">"some"</code> if not
      specified.</p></div></div><p>The array path is a "dot-notation" expression that can reference the following
variables in the watch context:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name                </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">ctx.metadata.*</code></p></td><td align="left" valign="top"><p>Any metadata associated with the watch.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ctx.payload.*</code></p></td><td align="left" valign="top"><p>The payload data loaded by the watch’s input.</p></td></tr></tbody></table></div><p>This array path must resolve to an array.</p><p>The comparison operator can be any one of the operators supported by the
<a class="link" href="condition.html#condition-compare-operators">Compare Condition</a>.</p><p>The quantifier operator can be any one of the following:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name    </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">all</code></p></td><td align="left" valign="top"><p>Returns <code class="literal">true</code> when the resolved value compares <code class="literal">true</code> according to
            the comparison operator for all the elements in the array</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">some</code></p></td><td align="left" valign="top"><p>Returns <code class="literal">true</code> when the resolved value compares <code class="literal">true</code> according to
            the comparison operator for at least one element in the array</p></td></tr></tbody></table></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If the array is empty, <code class="literal">all</code> causes the comparison operator to evaluate to
      <code class="literal">true</code> and <code class="literal">some</code> causes the comparison operator to evaluate to <code class="literal">false</code>.</p></div></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>It is also possible to use date math expressions and values in the context
      model as in the <a class="link" href="condition.html#condition-compare" title="Compare Condition">Compare Condition</a>.</p></div></div></div></div><div class="navfooter"><span class="prev"><a href="trigger.html">
              « 
              Triggers</a>
           
        </span><span class="next">
           
          <a href="actions.html">Actions
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        