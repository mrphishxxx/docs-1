<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Developing the Beat-Specific Code
        | Beats Platform Reference [1.1]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Beats Platform Reference [1.1]" /><link rel="up" href="new-beat.html" title="Developer Guide: Creating a New Beat" /><link rel="prev" href="_overview.html" title="Overview" /><link rel="next" href="_sharing_your_beat_with_the_community.html" title="Sharing Your Beat with the Community" /><meta name="DC.type" content="Docs/Libbeat/Reference/1.1" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b>
<br/>
This page is for an older version of the software. Check out the <a href="../current/index.html">latest
version&#39;s documentation here</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Beats Platform Reference
      [1.1]
    </a></span> » <span class="breadcrumb-link"><a href="new-beat.html">Developer Guide: Creating a New Beat</a></span> » <span class="breadcrumb-node">Developing the Beat-Specific Code</span></div><div class="navheader"><span class="prev"><a href="_overview.html">
              « 
              Overview</a>
           
        </span><span class="next">
           
          <a href="_sharing_your_beat_with_the_community.html">Sharing Your Beat with the Community
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_developing_the_beat_specific_code"></a>Developing the Beat-Specific Code<a href="https://github.com/elastic/beats/edit/1.1/libbeat/docs/newbeat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The Beat-specific code should implement the <code class="literal">Beater</code> interface defined
in libbeat.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">type Beater interface {
        Config(*Beat) error
        Setup(*Beat) error
        Run(*Beat) error
        Cleanup(*Beat) error
        Stop()
}</pre></div><p>This means your Beat should implement the following methods:</p><div class="horizontal"><table cellpadding="4px" border="0"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td valign="top">
<p>
<a class="link" href="_developing_the_beat_specific_code.html#config-method" title="Config Method">Config</a>
</p>
</td><td valign="top">
<p>
Deals with the configuration file and optionally with
custom CLI flags
</p>
</td></tr><tr><td valign="top">
<p>
<a class="link" href="_developing_the_beat_specific_code.html#setup-method" title="Setup Method">Setup</a>
</p>
</td><td valign="top">
<p>
Contains logic that executes before the main loop, usually for initialization
</p>
</td></tr><tr><td valign="top">
<p>
<a class="link" href="_developing_the_beat_specific_code.html#run-method" title="Run Method">Run</a>
</p>
</td><td valign="top">
<p>
Contains the main application loop that captures data
and sends it to the publisher
</p>
</td></tr><tr><td valign="top">
<p>
<a class="link" href="_developing_the_beat_specific_code.html#cleanup-method" title="Cleanup Method">Cleanup</a>
</p>
</td><td valign="top">
<p>
Contains logic that executes after the main loop finishes
(or is interrupted)
</p>
</td></tr><tr><td valign="top">
<p>
<a class="link" href="_developing_the_beat_specific_code.html#stop-method" title="Stop Method">Stop</a>
</p>
</td><td valign="top">
<p>
Contains logic that is called when the Beat is signaled to stop
</p>
</td></tr></tbody></table></div><p>The <code class="literal">Beat</code> parameter received by most of these methods contains data about the
Beat, such as the name, version, and common configuration options.</p><p>For more complex Beats, the optional <code class="literal">FlagsHandler</code> interface is available.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">type FlagsHandler interface {
        HandleFlags(*Beat)
}</pre></div><p>You can use the <code class="literal">FlagsHandler</code> interface to add additional command line flags to
your Beat. The <code class="literal">HandleFlags</code> callback is called after the Beat parses the
command line arguments inherited from libbeat and handles the <code class="literal">--help</code> and
<code class="literal">--version</code> flags. For an example of how to implement <code class="literal">HandleFlags</code>, take a look
at the <a class="ulink" href="https://github.com/elastic/beats/blob/master/packetbeat/beat/packetbeat.go" target="_top">Packetbeat</a>
code.</p><p>We strongly recommend that you create a main package that contains only the main
method. All your Beat-specific code should go in a separate folder and package.
This will allow other Beats to use the other parts of your Beat as a library, if
needed.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>To be consistent with other Beats, you should append <code class="literal">beat</code> to your Beat name.</p></div></div><p>Let’s go through each of the methods in the <code class="literal">Beater</code> interface and look at a
sample implementation.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="config-method"></a>Config Method<a href="https://github.com/elastic/beats/edit/1.1/libbeat/docs/newbeat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">Config</code> method deals with the configuration file and optionally with
custom CLI flags.</p><p>The recommended way of handling the configuration is to create a
<code class="literal">ConfigSettings</code> type that matches the structure of the expected configuration
file. Here is an example configuration section for Topbeat:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">input:
  period: 1

  procs: [".*"]</pre></div><p>And here are the corresponding Go structures, which are defined in <code class="literal">config.go</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">type TopConfig struct {
        Period *int64
        Procs  *[]string
}

type ConfigSettings struct {
        Input TopConfig
}</pre></div><p>Pointers are used to distinguish between when the setting is completely
missing from the configuration file and when it has a value that matches the
type’s default value.</p><p>With these structures defined, the <code class="literal">Config</code> method looks like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">func (tb *Topbeat) Config(b *beat.Beat) error {

        err := cfgfile.Read(&amp;tb.TbConfig, "") <a id="CO2-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        if err != nil {
                logp.Err("Error reading configuration file: %v", err)
                return err
        }

        if tb.TbConfig.Input.Period != nil { <a id="CO2-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
                tb.period = time.Duration(*tb.TbConfig.Input.Period) * time.Second
        } else {
                tb.period = 1 * time.Second
        }

        [...]

        return nil
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Read the configuration.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set default values for options that are not present in the configuration
    file.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="setup-method"></a>Setup Method<a href="https://github.com/elastic/beats/edit/1.1/libbeat/docs/newbeat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">Setup</code> method enables you to execute logic before the main
loop, usually for initialization. In the Topbeat implementation, this method
only assigns the Beat object to the Topbeat object, so it doesn’t have to be
passed to all sub-functions.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">func (tb *Topbeat) Setup(b *beat.Beat) error {

        tb.Beat = b
        return nil
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="run-method"></a>Run Method<a href="https://github.com/elastic/beats/edit/1.1/libbeat/docs/newbeat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">Run</code> method should contain your main application loop. For Topbeat it looks
like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">func (t *Topbeat) Run(b *beat.Beat) error {

        t.isAlive = true

        t.initProcStats()

        var err error

        for t.isAlive {
                time.Sleep(t.period)

                err = t.exportSystemStats()
                if err != nil {
                        logp.Err("Error reading system stats: %v", err)
                }
                [...]
        }

        return err
}</pre></div><p>Inside the loop, Topbeat sleeps for a configurable period of time and then
captures the required data and sends it to the publisher via the <code class="literal">events</code>
publisher client. The publisher client is available as part of the Beat object
through the <code class="literal">Beat.Events</code> variable.</p><p>The actual sending is done inside the <code class="literal">exportSystemStats()</code> method:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">func (t *Topbeat) exportSystemStats() error {

        load_stat, err := GetSystemLoad()
        if err != nil {
                logp.Warn("Getting load statistics: %v", err)
                return err
        }

        [...]

        event := common.MapStr{ <a id="CO3-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
                "@timestamp": common.Time(time.Now()), <a id="CO3-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
                "type":      "system",
                "load":      load_stat,
                "cpu":       cpu_stat,
                "mem":       mem_stat,
                "swap":      swap_stat,
        }

        t.Beat.Events.PublishEvent(event) <a id="CO3-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>

        return nil
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Create the event object.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Specify a <code class="literal">@timestamp</code> field of time <code class="literal">common.Time</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Send the event.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cleanup-method"></a>Cleanup Method<a href="https://github.com/elastic/beats/edit/1.1/libbeat/docs/newbeat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">Cleanup</code> method is executed after the main loop finishes (or is interrupted)
and gives you the opportunity to release any resources you might use. For
Topbeat, the method is completely empty:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">func (tb *Topbeat) Cleanup(b *beat.Beat) error {
        return nil
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="stop-method"></a>Stop Method<a href="https://github.com/elastic/beats/edit/1.1/libbeat/docs/newbeat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">Stop</code> method is called when the Beat is signaled to stop, for
example through the SIGTERM signal on Unix systems or the service control
interface on Windows. For Topbeat, this method simply sets <code class="literal">isAlive</code> to
<code class="literal">false</code>, which breaks the main loop.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">func (t *Topbeat) Stop() {
        t.isAlive = false
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_the_main_function"></a>The main Function<a href="https://github.com/elastic/beats/edit/1.1/libbeat/docs/newbeat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>If you follow the Topbeat model and put your Beat-specific code in its own type
that implements the <code class="literal">Beater</code> interface, the code from your main package is
very simple:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-go">var Version = "1.0.0"
var Name = "topbeat"

func main() {
        beat.Run(Name, Version, topbeat.New())
}</pre></div><p>We recommend that you implement a <code class="literal">New</code> function that creates your Beats object.</p></div></div><div class="navfooter"><span class="prev"><a href="_overview.html">
              « 
              Overview</a>
           
        </span><span class="next">
           
          <a href="_sharing_your_beat_with_the_community.html">Sharing Your Beat with the Community
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        