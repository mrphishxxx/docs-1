<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Event Dependent Configuration
        | Reference [1.5]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Reference [1.5]" /><link rel="up" href="configuration.html" title="Configuring Logstash" /><link rel="prev" href="configuration-file-structure.html" title="Structure of a Config File" /><link rel="next" href="config-examples.html" title="Logstash Configuration Examples" /><meta name="DC.type" content="Docs/Logstash/Reference/1.5" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b>
<br/>
This page is for an older version of the software. Check out the <a href="../current/index.html">latest
version&#39;s documentation here</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Reference
      [1.5]
    </a></span> » <span class="breadcrumb-link"><a href="configuration.html">Configuring Logstash</a></span> » <span class="breadcrumb-node">Event Dependent Configuration</span></div><div class="navheader"><span class="prev"><a href="configuration-file-structure.html">
              « 
              Structure of a Config File</a>
           
        </span><span class="next">
           
          <a href="config-examples.html">Logstash Configuration Examples
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="event-dependent-configuration"></a>Event Dependent Configuration<a href="https://github.com/elastic/logstash/edit/master/docs/asciidoc/static/configuration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The logstash agent is a processing pipeline with 3 stages: inputs → filters →
outputs. Inputs generate events, filters modify them, outputs ship them
elsewhere.</p><p>All events have properties. For example, an apache access log would have things
like status code (200, 404), request path ("/", "index.html"), HTTP verb
(GET, POST), client IP address, etc. Logstash calls these properties "fields."</p><p>Some of the configuration options in Logstash require the existence of fields in
order to function.  Because inputs generate events, there are no fields to
evaluate within the input block—they do not exist yet!</p><p>Because of their dependency on events and fields, the following configuration
options will only work within filter and output blocks.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Field references, sprintf format and conditionals, described below,
will not work in an input block.</p></div></div><h4><a id="logstash-config-field-references"></a>Field References<a href="https://github.com/elastic/logstash/edit/master/docs/asciidoc/static/configuration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>It is often useful to be able to refer to a field by name. To do this,
you can use the Logstash field reference syntax.</p><p>The syntax to access a field is <code class="literal">[fieldname]</code>. If you are referring to a
<span class="strong"><strong>top-level field</strong></span>, you can omit the <code class="literal">[]</code> and simply use <code class="literal">fieldname</code>.
To refer to a <span class="strong"><strong>nested field</strong></span>, you specify
the full path to that field: <code class="literal">[top-level field][nested field]</code>.</p><p>For example, the following event has five top-level fields (agent, ip, request, response,
ua) and three nested fields (status, bytes, os).</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "agent": "Mozilla/5.0 (compatible; MSIE 9.0)",
  "ip": "192.168.24.44",
  "request": "/index.html"
  "response": {
    "status": 200,
    "bytes": 52353
  },
  "ua": {
    "os": "Windows 7"
  }
}</pre></div><p>To reference the <code class="literal">os</code> field, you specify <code class="literal">[ua][os]</code>. To reference a top-level
field such as <code class="literal">request</code>, you can simply specify the field name.</p><h4><a id="sprintf"></a>sprintf format<a href="https://github.com/elastic/logstash/edit/master/docs/asciidoc/static/configuration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The field reference format is also used in what Logstash calls <span class="emphasis"><em>sprintf format</em></span>. This format
enables you to refer to field values from within other strings. For example, the
statsd output has an <span class="emphasis"><em>increment</em></span> setting that enables you to keep a count of
apache logs by status code:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">output {
  statsd {
    increment =&gt; "apache.%{[response][status]}"
  }
}</pre></div><p>You can also format times using this sprintf format. Instead of specifying a field name, use the <code class="literal">+FORMAT</code> syntax where <code class="literal">FORMAT</code> is a <a class="ulink" href="http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html" target="_top">time format</a>.</p><p>For example, if you want to use the file output to write to logs based on the
hour and the <span class="emphasis"><em>type</em></span> field:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">output {
  file {
    path =&gt; "/var/log/%{type}.%{+yyyy.MM.dd.HH}"
  }
}</pre></div><h4><a id="conditionals"></a>Conditionals<a href="https://github.com/elastic/logstash/edit/master/docs/asciidoc/static/configuration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Sometimes you only want to filter or output an event under
certain conditions. For that, you can use a conditional.</p><p>Conditionals in Logstash look and act the same way they do in programming
languages. Conditionals support <code class="literal">if</code>, <code class="literal">else if</code> and <code class="literal">else</code> statements
and can be nested.</p><p>The conditional syntax is:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">if EXPRESSION {
  ...
} else if EXPRESSION {
  ...
} else {
  ...
}</pre></div><p>What’s an expression? Comparison tests, boolean logic, and so on!</p><p>You can use the following comparison operators:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
equality: <code class="literal">==</code>,  <code class="literal">!=</code>,  <code class="literal">&lt;</code>,  <code class="literal">&gt;</code>,  <code class="literal">&lt;=</code>, <code class="literal">&gt;=</code>
</li><li class="listitem">
regexp: <code class="literal">=~</code>, <code class="literal">!~</code>
</li><li class="listitem">
inclusion: <code class="literal">in</code>, <code class="literal">not in</code>
</li></ul></div><p>The supported boolean operators are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">and</code>, <code class="literal">or</code>, <code class="literal">nand</code>, <code class="literal">xor</code>
</li></ul></div><p>The supported unary operators are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">!</code>
</li></ul></div><p>Expressions can be long and complex. Expressions can contain other expressions,
you can negate expressions with <code class="literal">!</code>, and you can group them with parentheses <code class="literal">(...)</code>.</p><p>For example, the following conditional uses the mutate filter to remove the field <code class="literal">secret</code> if the field
<code class="literal">action</code> has a value of <code class="literal">login</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">filter {
  if [action] == "login" {
    mutate { remove =&gt; "secret" }
  }
}</pre></div><p>You can specify multiple expressions in a single condition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">output {
  # Send production errors to pagerduty
  if [loglevel] == "ERROR" and [deployment] == "production" {
    pagerduty {
    ...
    }
  }
}</pre></div><p>The <code class="literal">in</code> conditional enables you to compare against the value of a field:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">filter {
  if [foo] in [foobar] {
    mutate { add_tag =&gt; "field in field" }
  }
  if [foo] in "foo" {
    mutate { add_tag =&gt; "field in string" }
  }
  if "hello" in [greeting] {
    mutate { add_tag =&gt; "string in field" }
  }
  if [foo] in ["hello", "world", "foo"] {
    mutate { add_tag =&gt; "field in list" }
  }
  if [missing] in [alsomissing] {
    mutate { add_tag =&gt; "shouldnotexist" }
  }
  if !("foo" in ["hello", "world"]) {
    mutate { add_tag =&gt; "shouldexist" }
  }
}</pre></div><p>You use the <code class="literal">not in</code> conditional the same way. For example,
you could use <code class="literal">not in</code> to only route events to elasticsearch
when <code class="literal">grok</code> is successful:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">output {
  if "_grokparsefailure" not in [tags] {
    elasticsearch { ... }
  }
}</pre></div><p>For more complex examples, see <a class="link" href="config-examples.html#using-conditionals" title="Using Conditionalsedit">Using Conditionals</a>.</p><h4><a id="metadata"></a>The @metadata field<a href="https://github.com/elastic/logstash/edit/master/docs/asciidoc/static/configuration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>In Logstash 1.5 there is a new, special field, called <code class="literal">@metadata</code>.  The contents
of <code class="literal">@metadata</code> will not be part of any of your events at output time, which
makes it great to use for conditionals, or extending and building event fields
with field reference and sprintf formatting.</p><p>The following configuration file will yield events from STDIN.  Whatever is
typed will become the <code class="literal">message</code> field in the event.  The <code class="literal">mutate</code> events in the
filter block will add a few fields, some nested in the <code class="literal">@metadata</code> field.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-ruby">input { stdin { } }

filter {
  mutate { add_field =&gt; { "show" =&gt; "This data will be in the output" } }
  mutate { add_field =&gt; { "[@metadata][test]" =&gt; "Hello" } }
  mutate { add_field =&gt; { "[@metadata][no_show]" =&gt; "This data will not be in the output" } }
}

output {
  if [@metadata][test] == "Hello" {
    stdout { codec =&gt; rubydebug }
  }
}</pre></div><p>Let’s see what comes out:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-ruby">$ bin/logstash -f ../test.conf
Logstash startup completed
asdf
{
       "message" =&gt; "asdf",
      "@version" =&gt; "1",
    "@timestamp" =&gt; "2015-03-18T23:09:29.595Z",
          "host" =&gt; "example.com",
          "show" =&gt; "This data will be in the output"
}</pre></div><p>The "asdf" typed in became the <code class="literal">message</code> field contents, and the conditional
successfully evaluated the contents of the <code class="literal">test</code> field nested within the
<code class="literal">@metadata</code> field.  But the output did not show a field called <code class="literal">@metadata</code>, or
its contents.</p><p>The <code class="literal">rubydebug</code> codec allows you to reveal the contents of the <code class="literal">@metadata</code> field
if you add a config flag, <code class="literal">metadata =&gt; true</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-ruby">    stdout { codec =&gt; rubydebug { metadata =&gt; true } }</pre></div><p>Let’s see what the output looks like with this change:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-ruby">$ bin/logstash -f ../test.conf
Logstash startup completed
asdf
{
       "message" =&gt; "asdf",
      "@version" =&gt; "1",
    "@timestamp" =&gt; "2015-03-18T23:10:19.859Z",
          "host" =&gt; "example.com",
          "show" =&gt; "This data will be in the output",
     "@metadata" =&gt; {
           "test" =&gt; "Hello",
        "no_show" =&gt; "This data will not be in the output"
    }
}</pre></div><p>Now you can see the <code class="literal">@metadata</code> field and its sub-fields.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Only the <code class="literal">rubydebug</code> codec allows you to show the contents of the
<code class="literal">@metadata</code> field.</p></div></div><p>Make use of the <code class="literal">@metadata</code> field any time you need a temporary field but do not
want it to be in the final output.</p><p>Perhaps one of the most common use cases for this new field is with the <code class="literal">date</code>
filter and having a temporary timestamp.</p><p>This configuration file has been simplified, but uses the timestamp format
common to Apache and Nginx web servers.  In the past, you’d have to delete
the timestamp field yourself, after using it to overwrite the <code class="literal">@timestamp</code>
field.  With the <code class="literal">@metadata</code> field, this is no longer necessary:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-ruby">input { stdin { } }

filter {
  grok { match =&gt; [ "message", "%{HTTPDATE:[@metadata][timestamp]}" ] }
  date { match =&gt; [ "[@metadata][timestamp]", "dd/MMM/yyyy:HH:mm:ss Z" ] }
}

output {
  stdout { codec =&gt; rubydebug }
}</pre></div><p>Notice that this configuration puts the extracted date into the
<code class="literal">[@metadata][timestamp]</code> field in the <code class="literal">grok</code> filter.  Let’s feed this
configuration a sample date string and see what comes out:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-ruby">$ bin/logstash -f ../test.conf
Logstash startup completed
02/Mar/2014:15:36:43 +0100
{
       "message" =&gt; "02/Mar/2014:15:36:43 +0100",
      "@version" =&gt; "1",
    "@timestamp" =&gt; "2014-03-02T14:36:43.000Z",
          "host" =&gt; "example.com"
}</pre></div><p>That’s it!  No extra fields in the output, and a cleaner config file because you
do not have to delete a "timestamp" field after conversion in the <code class="literal">date</code> filter.</p><p>Another use case is the CouchDB Changes input plugin (See
<a class="ulink" href="https://github.com/logstash-plugins/logstash-input-couchdb_changes" target="_top">https://github.com/logstash-plugins/logstash-input-couchdb_changes</a>).
This plugin automatically captures CouchDB document field metadata into the
<code class="literal">@metadata</code> field within the input plugin itself.  When the events pass through
to be indexed by Elasticsearch, the Elasticsearch output plugin allows you to
specify the <code class="literal">action</code> (delete, update, insert, etc.) and the <code class="literal">document_id</code>, like
this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-ruby">output {
  elasticsearch {
    action =&gt; "%{[@metadata][action]}"
    document_id =&gt; "%{[@metadata][_id]}"
    host =&gt; "example.com"
    index =&gt; "index_name"
    protocol =&gt; "http"
  }
}</pre></div></div><div class="navfooter"><span class="prev"><a href="configuration-file-structure.html">
              « 
              Structure of a Config File</a>
           
        </span><span class="next">
           
          <a href="config-examples.html">Logstash Configuration Examples
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        