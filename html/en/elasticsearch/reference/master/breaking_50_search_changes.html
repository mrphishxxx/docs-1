<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Search and Query DSL changes
        | Elasticsearch Reference [master]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [master]" /><link rel="up" href="breaking-changes-5.0.html" title="Breaking changes in 5.0" /><link rel="prev" href="breaking-changes-5.0.html" title="Breaking changes in 5.0" /><link rel="next" href="breaking_50_mapping_changes.html" title="Mapping changes" /><meta name="DC.type" content="Docs/Elasticsearch/Reference/master" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b>
<br/>
This page is for an as yet unreleased version of the software. Check out the <a href="../current/index.html">latest
version&#39;s documentation here</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="breaking-changes.html">Breaking changes </a></span> » <span class="breadcrumb-link"><a href="breaking-changes-5.0.html">Breaking changes in 5.0</a></span> » <span class="breadcrumb-node">Search and Query DSL changes</span></div><div class="navheader"><span class="prev"><a href="breaking-changes-5.0.html">
              « 
              Breaking changes in 5.0</a>
           
        </span><span class="next">
           
          <a href="breaking_50_mapping_changes.html">Mapping changes
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="breaking_50_search_changes"></a>Search and Query DSL changes<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_literal_search_type_literal"></a><code class="literal">search_type</code><a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_literal_search_type_count_literal_removed"></a><code class="literal">search_type=count</code> removed<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>The <code class="literal">count</code> search type was deprecated since version 2.0.0 and is now removed.
In order to get the same benefits, you just need to set the value of the <code class="literal">size</code>
parameter to <code class="literal">0</code>.</p><p>For instance, the following request:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sh">GET /my_index/_search?search_type=count
{
  "aggs": {
    "my_terms": {
       "terms": {
         "field": "foo"
       }
     }
  }
}</pre></div><p>can be replaced with:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sh">GET /my_index/_search
{
  "size": 0,
  "aggs": {
    "my_terms": {
       "terms": {
         "field": "foo"
       }
     }
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_literal_search_type_scan_literal_removed"></a><code class="literal">search_type=scan</code> removed<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>The <code class="literal">scan</code> search type was deprecated since version 2.1.0 and is now removed.
All benefits from this search type can now be achieved by doing a scroll
request that sorts documents in <code class="literal">_doc</code> order, for instance:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sh">GET /my_index/_search?scroll=2m
{
  "sort": [
    "_doc"
  ]
}</pre></div><p>Scroll requests sorted by <code class="literal">_doc</code> have been optimized to more efficiently resume
from where the previous request stopped, so this will have the same performance
characteristics as the former <code class="literal">scan</code> search type.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_literal_fields_literal_parameter"></a><code class="literal">fields</code> parameter<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">fields</code> parameter used to try to retrieve field values from stored
fields, and fall back to extracting from the <code class="literal">_source</code> if a field is not
marked as stored.  Now, the <code class="literal">fields</code> parameter will only return stored fields — it will no longer extract values from the <code class="literal">_source</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_search_exists_api_removed"></a>search-exists API removed<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The search exists api has been removed in favour of using the search api with
<code class="literal">size</code> set to <code class="literal">0</code> and <code class="literal">terminate_after</code> set to <code class="literal">1</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_deprecated_queries_removed"></a>Deprecated queries removed<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The following deprecated queries have been removed:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">filtered</code>
</span></dt><dd>
Use <code class="literal">bool</code> query instead, which supports <code class="literal">filter</code> clauses too.
</dd><dt><span class="term">
<code class="literal">and</code>
</span></dt><dd>
Use <code class="literal">must</code> clauses in a <code class="literal">bool</code> query instead.
</dd><dt><span class="term">
<code class="literal">or</code>
</span></dt><dd>
Use <code class="literal">should</code> clauses in a <code class="literal">bool</code> query instead.
</dd><dt><span class="term">
<code class="literal">limit</code>
</span></dt><dd>
Use the <code class="literal">terminate_after</code> parameter instead.
</dd><dt><span class="term">
<code class="literal">fquery</code>
</span></dt><dd>
Is obsolete after filters and queries have been merged.
</dd><dt><span class="term">
<code class="literal">query</code>
</span></dt><dd>
Is obsolete after filters and queries have been merged.
</dd><dt><span class="term">
<code class="literal">query_binary</code>
</span></dt><dd>
Was undocumented and has been removed.
</dd><dt><span class="term">
<code class="literal">filter_binary</code>
</span></dt><dd>
Was undocumented and has been removed.
</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_to_queries"></a>Changes to queries<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Unsupported queries such as term queries on <code class="literal">geo_point</code> fields will now fail
  rather than returning no hits.
</li><li class="listitem">
Removed support for fuzzy queries on numeric, date and ip fields, use range
  queries instead.
</li><li class="listitem">
Removed support for range and prefix queries on <code class="literal">_uid</code> and <code class="literal">_id</code> fields.
</li><li class="listitem">
Querying an unindexed field will now fail rather than returning no hits.
</li><li class="listitem">
Removed support for the deprecated <code class="literal">min_similarity</code> parameter in <code class="literal">fuzzy
  query</code>, in favour of <code class="literal">fuzziness</code>.
</li><li class="listitem">
Removed support for the deprecated <code class="literal">fuzzy_min_sim</code> parameter in
  <code class="literal">query_string</code> query, in favour of <code class="literal">fuzziness</code>.
</li><li class="listitem">
Removed support for the deprecated <code class="literal">edit_distance</code> parameter in completion
  suggester, in favour of <code class="literal">fuzziness</code>.
</li><li class="listitem">
Removed support for the deprecated <code class="literal">filter</code> and <code class="literal">no_match_filter</code> fields in <code class="literal">indices</code> query,
in favour of <code class="literal">query</code> and <code class="literal">no_match_query</code>.
</li><li class="listitem">
Removed support for the deprecated <code class="literal">filter</code> fields in <code class="literal">nested</code> query, in favour of <code class="literal">query</code>.
</li><li class="listitem">
Removed support for the deprecated <code class="literal">minimum_should_match</code> and
  <code class="literal">disable_coord</code> in <code class="literal">terms</code> query, use <code class="literal">bool</code> query instead. Also removed
  support for the deprecated <code class="literal">execution</code> parameter.
</li><li class="listitem">
Removed support for the top level <code class="literal">filter</code> element in <code class="literal">function_score</code> query, replaced by <code class="literal">query</code>.
</li><li class="listitem">
The <code class="literal">collect_payloads</code> parameter of the <code class="literal">span_near</code> query has been deprecated.  Payloads will be loaded when needed.
</li><li class="listitem">
The <code class="literal">score_type</code> parameter to the <code class="literal">nested</code> and <code class="literal">has_child</code> queries has been
  removed in favour of <code class="literal">score_mode</code>.  The <code class="literal">score_mode</code> parameter to <code class="literal">has_parent</code>
  has been deprecated in favour of the <code class="literal">score</code> boolean parameter.   Also, the
  <code class="literal">total</code> score mode has been removed in favour of the <code class="literal">sum</code> mode.
</li><li class="listitem">
When the <code class="literal">max_children</code> parameter was set to <code class="literal">0</code> on the <code class="literal">has_child</code> query
  then there was no upper limit on how many child documents were allowed to
  match. Now, <code class="literal">0</code> really means that zero child documents are allowed. If no
  upper limit is needed then the <code class="literal">max_children</code> parameter shouldn’t be specified
  at all.
</li><li class="listitem">
The <code class="literal">exists</code> query will now fail if the <code class="literal">_field_names</code> field is disabled.
</li><li class="listitem">
The <code class="literal">multi_match</code> query will fail if <code class="literal">fuzziness</code> is used for <code class="literal">cross_fields</code>, <code class="literal">phrase</code> or <code class="literal">phrase_prefix</code> type.
This parameter was undocumented and silently ignored before for these types of <code class="literal">multi_match</code>.
</li><li class="listitem">
Deprecated support for the coerce, normalize, ignore_malformed parameters in GeoPolygonQuery. Use parameter validation_method instead.
</li><li class="listitem">
Deprecated support for the coerce, normalize, ignore_malformed parameters in GeoDistanceRangeQuery. Use parameter validation_method instead.
</li><li class="listitem">
Deprecated support for the coerce, normalize, ignore_malformed parameters in GeoDistanceQuery. Use parameter validation_method instead.
</li><li class="listitem">
Deprecated support for the coerce, normalize, ignore_malformed parameters in GeoBoundingBoxQuery. Use parameter validation_method instead.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_top_level_literal_filter_literal_parameter"></a>Top level <code class="literal">filter</code> parameter<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Removed support for the deprecated top level <code class="literal">filter</code> in the search api,
replaced by <code class="literal">post_filter</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_highlighters"></a>Highlighters<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Removed support for multiple highlighter names, the only supported ones are:
<code class="literal">plain</code>, <code class="literal">fvh</code> and <code class="literal">postings</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_term_vectors_api"></a>Term vectors API<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The term vectors APIs no longer persist unmapped fields in the mappings.</p><p>The <code class="literal">dfs</code> parameter to the term vectors API has been removed completely. Term
vectors don’t support distributed document frequencies anymore.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_sort"></a>Sort<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">reverse</code> parameter has been removed, in favour of explicitly
specifying the sort order with the <code class="literal">order</code> option.</p><p>The <code class="literal">coerce</code> and <code class="literal">ignore_malformed</code> parameters were deprecated in favour of <code class="literal">validation_method</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_inner_hits"></a>Inner hits<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Top level inner hits syntax has been removed. Inner hits can now only be specified as part of the <code class="literal">nested</code>,
<code class="literal">has_child</code> and <code class="literal">has_parent</code> queries. Use cases previously only possible with top level inner hits can now be done
with inner hits defined inside the query dsl.
</li><li class="listitem">
Source filtering for inner hits inside nested queries requires full field names instead of relative field names.
This is now consistent for source filtering on other places in the search API.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_query_profiler"></a>Query Profiler<a href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_5_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>In the response for profiling queries, the <code class="literal">query_type</code> has been renamed to <code class="literal">type</code> and <code class="literal">lucene</code> has been renamed to
<code class="literal">description</code>. These changes have been made so the response format is more friendly to supporting other types of profiling
in the future.</p></div></div><div class="navfooter"><span class="prev"><a href="breaking-changes-5.0.html">
              « 
              Breaking changes in 5.0</a>
           
        </span><span class="next">
           
          <a href="breaking_50_mapping_changes.html">Mapping changes
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        