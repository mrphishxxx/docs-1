<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Mapping and Types
        | Elasticsearch for Apache Hadoop [2.2]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch for Apache Hadoop [2.2]" /><link rel="up" href="reference.html" title="Elasticsearch for Apache Hadoop" /><link rel="prev" href="storm.html" title="Apache Storm support" /><link rel="next" href="metrics.html" title="Hadoop Metrics" /><meta name="DC.type" content="Docs/Elasticsearch/Apache Hadoop/2.2" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b>
<br/>
This page is for an older version of the software. Check out the <a href="../current/index.html">latest
version&#39;s documentation here</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch for Apache Hadoop
      [2.2]
    </a></span> » <span class="breadcrumb-link"><a href="reference.html">Elasticsearch for Apache Hadoop </a></span> » <span class="breadcrumb-node">Mapping and Types</span></div><div class="navheader"><span class="prev"><a href="storm.html">
              « 
              Apache Storm support</a>
           
        </span><span class="next">
           
          <a href="metrics.html">Hadoop Metrics
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="mapping"></a>Mapping and Types<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>As explained in the previous sections, elasticsearch-hadoop integrates closely with the Hadoop ecosystem and perform close introspection of the type information so that the data flow between Elasticsearch and Hadoop is as transparent as possible.
This section takes a closer look at how the type conversion takes place and how data is mapped between the two systems.</p><h3><a id="_converting_data_to_elasticsearch"></a>Converting data to Elasticsearch<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>By design, elasticsearch-hadoop provides no data transformation or mapping layer itself simply because there is no need for them: Hadoop is designed to do ETL and some libraries (like Pig and Hive) provide type information themselves; further more Elasticsearch has rich support for mapping out of the box including automatic detection,  dynamic/schema-less mapping, templates and full manual control.
Need to split strings into token, do data validation or eliminate unneeded data ? There are plenty of ways to do that in Hadoop before reading/writing data from/to Elasticsearch; need control over how data is stored in Elasticsearch ? Use Elasticsearch APIs to define the  <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/indices-put-mapping.html" target="_top">mapping</a>, to update <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/indices-update-settings.html" target="_top">settings</a> or add generic <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/mapping-fields.html" target="_top">meta-data</a>.</p><h3><a id="mapping-date"></a>Time/Date mapping<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>When it comes to handling dates, Elasticsearch always uses the <a class="ulink" href="http://en.wikipedia.org/wiki/ISO_8601" target="_top">ISO 8601</a> format for date/time. This is the default date format of Elasticsearch - if a custom one is needed, please <span class="strong"><strong>add</strong></span> it to the default option rather then just replacing it. See the <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/mapping-date-format.html" target="_top">date format</a> section in Elasticsearch reference documentation for more information.
Note that when reading data, if the date is not in ISO8601 format, by default elasticsearch-hadoop will likely not understand it as it does not replicate the elaborate date parsing in Elasticsearch. In these cases one can simply disable the date conversion
and pass the raw information as a <code class="literal">long</code> or <code class="literal">String</code>, through the <code class="literal">es.mapping.rich.date</code> <a class="link" href="configuration.html#cfg-field-info" title="Field information (when reading from Elasticsearch)edit">property</a>.</p><p>As a side note, elasticsearch-hadoop tries to detect whether dedicated date parsing libraries (in particular Joda, used also by Elasticsearch) are available at runtime and if so, will use them. If not, it will default to parsing using JDK classes which are not
as rich. Going forward especially with the advent of JDK 8, elasticsearch-hadoop will try to migrate to <code class="literal">javax.time</code> library to have the same behaviour regardless of the classpath available at runtime.</p><h3><a id="mapping-arrays"></a>Ordering and Mapping<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>It is important to note that JSON objects (delimited by <code class="literal">{}</code> and typically associated with maps) are <span class="strong"><strong>unordered</strong></span>, in other words, they do <span class="strong"><strong>not</strong></span> maintain order. JSON
arrays (typically associated with lists or sequences) are <span class="strong"><strong>ordered</strong></span>, that is, they <span class="strong"><strong>do</strong></span> preserve the initial insertion order. This impacts the way objects are read from Elasticsearch as one might find the insertion structure to be different than the extraction one.
It is however easy to circumvent this problem - as JSON objects (maps) contain fields, use the field names (or keys) instead of their position inside the document to reliably get their values (in Java terms think of a JSON object as a <code class="literal">HashMap</code> as oppose to a <code class="literal">LinkedHashMap</code>).</p><h3><a id="mapping-geo"></a>Geo types<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>For geolocation Elasticsearch provides two dedicated types, namely <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/2.1/geo-point.html" target="_top"><code class="literal">geo_point</code></a> and <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/2.1/geo-shape.html" target="_top"><code class="literal">geo_shape</code></a>
which do not have a direct equivalent in any of the libraries elasticsearch-hadoop integrates with. Further more, Elasticsearch accepts multiple formats for each type (as there are different ways to represent data), in fact there are 4 different representations
for <code class="literal">geo_point</code> and 9 for <code class="literal">geo_shape</code>.
To go around this, the connector breaks down the geo types into primitives depending on the actual format used for their respective types.</p><p>For strongly-typed libraries (like SparkSQL <code class="literal">DataFrame</code>s), the format needs to be known before hand and thus, elasticsearch-hadoop will <span class="emphasis"><em>sample</em></span> the data asking elasticsearch-hadoop for one random document that is representative of the mapping, parse it and based
on the values found, identify the format used and create the necessary schema. This happens automatically at start-up without any user interference. As always, the user data must all be using the <span class="emphasis"><em>same</em></span> format (a requirement from
SparkSQL) otherwise reading a different format will trigger an exception.</p><p>Note that typically handling of these types poses no issues for the user whether reading or writing data.</p><h3><a id="mapping-multi-values"></a>Handling array/multi-values fields<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Elasticsearch treats fields with single or multi-values the same; in fact the mapping provides no information about this. As a client though, it means one cannot tell whether a field is single-valued or not until is actually being read. In most cases this is not an issue and elasticsearch-hadoop automatically creates the necessary list/array on the fly. However in environments with strict schema such as Spark SQL, changing a field actual value from its declared type is not allowed worse yet, this information needs to be available even before reading the data. And since the mapping is not conclusive enough, elasticsearch-hadoop allows the user to specify the extra information through <a class="link" href="configuration.html#cfg-field-info" title="Field information (when reading from Elasticsearch)edit">field information</a> specifically <code class="literal">es.field.read.as.array.include</code> and <code class="literal">es.field.read.as.array.include</code>.</p><h3><a id="_automatic_mapping"></a>Automatic mapping<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>By default, Elasticsearch provides <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/docs-index_.html" target="_top">automatic index and mapping</a> when data is added under an index that has not been created before. In other words, data can be added into Elasticsearch without the index and the mappings being defined a priori. This is quite convenient since Elasticsearch automatically adapts to the data being fed to it - moreover, if certain entries have extra fields, Elasticsearch schema-less nature allows them to be indexed without any issues.</p><p><a id="auto-mapping-type-loss"></a>It is important to remember that automatic mapping uses the payload values to identify its <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/mapping.html#mapping-type" target="_top">type</a>, using the <span class="strong"><strong>first document</strong></span> creates the mapping. elasticsearch-hadoop communicates with Elasticsearch through JSON which does not provide any type information, rather only the field names and their values. One can think of it as <span class="emphasis"><em>type erasure</em></span> or information loss; for example JSON does not differentiate integer numeric types - <code class="literal">byte</code>, <code class="literal">short</code>, <code class="literal">int</code>, <code class="literal">long</code> are all placed in the same <code class="literal">long</code> <span class="emphasis"><em>bucket</em></span>. this can have unexpected side-effects since the type information is <span class="emphasis"><em>guessed</em></span> such as:</p><h5><a id="_numbers_mapped_only_as_literal_long_literal_literal_double_literal"></a>numbers mapped only as <code class="literal">long</code>/<code class="literal">double</code><a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>Whenever Elasticsearch encounters a number, it will allocate the largest type for it since it does not know the exact number type of the field. Allocating a small type (such as <code class="literal">byte</code>, <code class="literal">int</code> or <code class="literal">float</code>) can lead to problems if a future document is larger, so Elasticsearch uses a safe default.
For example, the document:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">{
    "tweet" {
        "user" : "kimchy",
        "message" : "This is a tweet!",
        "postDate" : "2009-11-15T14:12:12",
        "priority" : 4,
        "rank" : 12.3
    }
}</pre></div><p>triggers the following mapping:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">{ "test" : {
    "mappings" : {
      "index" : {
        "properties" : {
          "message" : {
            "type" : "string"
          },
          "postDate" : {
            "type" : "date",
            "format" : "dateOptionalTime"      <a id="CO94-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
          },
          "priority" : {
            "type" : "long"                    <a id="CO94-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
          },
          "rank" : {
            "type" : "double"                  <a id="CO94-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
          },
          "user" : {
            "type" : "string"
          }
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO94-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <span class="emphasis"><em>postDate</em></span> field was recognized as a date in ISO 8601 format (<code class="literal">dateOptionalTime</code>)
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO94-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <span class="emphasis"><em>integer</em></span> number (<code class="literal">4</code>) was mapped to the largest available type (<code class="literal">long</code>)
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO94-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <span class="emphasis"><em>fractional</em></span> number (<code class="literal">12.3</code>) was mapped to the largest available type (<code class="literal">double</code>)
</p></td></tr></table></div><h5><a id="_incorrect_mapping"></a>incorrect mapping<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>This happens when a string field contains numbers (say <code class="literal">1234</code>) - Elasticsearch has no information that the number is actually a string and thus it map the field as a number, causing a parsing exception when a string is encountered.
For example, this document:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">{ "array":[123, "string"] }</pre></div><p>causes an exception with automatic mapping:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">{"error":"MapperParsingException[failed to parse [array]]; nested: NumberFormatException[For input string: \"string\"]; ","status":400}</pre></div><p>because the field <code class="literal">array</code> is initially detected as a number (because of <code class="literal">123</code>) which causes <code class="literal">"string"</code> to trigger the parsing exception since clearly it is not a number. The same issue tends to occur with strings might be
interpreted as dates.</p><p>Hence if the defaults need to be overridden and/or if you experience the problems exposed above, potentially due to a diverse dataset, consider using <a class="xref" href="mapping.html#explicit-mapping" title="Explicit mappingedit">the section called “Explicit mapping<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a>”</a>.</p><h4><a id="_disabling_automatic_mapping"></a>Disabling automatic mapping<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Elasticsearch allows <span class="emphasis"><em>automatic index creation</em></span> as well as <span class="emphasis"><em>dynamic mapping</em></span> (for extra fields present in documents) to be disabled through the <code class="literal">action.auto_create_index</code> and <code class="literal">index.mapper.dynamic</code> settings on the nodes config files. As a safety net, elasticsearch-hadoop provides a dedicated configuration <a class="link" href="configuration.html#configuration-options-index" title="Indexedit">option</a> <code class="literal">es.index.auto.create</code> which allows elasticsearch-hadoop to either create the index or not without having to modify the Elasticsearch cluster options.</p><h3><a id="explicit-mapping"></a>Explicit mapping<a href="https://github.com/elastic/elasticsearch-hadoop/edit/2.2/docs/src/reference/asciidoc/core/mapping.adoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Explicit or manual mapping should be considered when the defaults need to be overridden, if the data is detected incorrectly (as explained above) or, in most cases, to customize the index analysis.
Refer to Elasticsearch <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/indices-create-index.html" target="_top">create index</a> and <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/indices-put-mapping.html" target="_top">mapping</a> documentation on how to define an index and its types - note that these need to be present <span class="strong"><strong>before</strong></span> data is being uploaded to Elasticsearch (otherwise automatic mapping will be used by Elasticsearch, if enabled).</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>In most cases, <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/indices-templates.html" target="_top">templates</a> are quite handy as they are automatically applied to new indices created that match the pattern; in other words instead of defining the mapping per index, one can just define the template once and then have it applied to all indices that match its pattern.</p></div></div></div><div class="navfooter"><span class="prev"><a href="storm.html">
              « 
              Apache Storm support</a>
           
        </span><span class="next">
           
          <a href="metrics.html">Hadoop Metrics
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        