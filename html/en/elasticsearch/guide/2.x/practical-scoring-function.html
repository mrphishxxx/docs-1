<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Lucene’s Practical Scoring Function
        | Elasticsearch: The Definitive Guide [2.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [2.x]" /><link rel="up" href="controlling-relevance.html" title="Controlling Relevance" /><link rel="prev" href="scoring-theory.html" title="Theory Behind Relevance Scoring" /><link rel="next" href="query-time-boosting.html" title="Query-Time Boosting" /><meta name="DC.type" content="Docs/Elasticsearch/Definitive Guide/2.x" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [2.x]
    </a></span> » <span class="breadcrumb-link"><a href="search-in-depth.html">Search in Depth </a></span> » <span class="breadcrumb-link"><a href="controlling-relevance.html">Controlling Relevance</a></span> » <span class="breadcrumb-node">Lucene’s Practical Scoring Function</span></div><div class="navheader"><span class="prev"><a href="scoring-theory.html">
              « 
              Theory Behind Relevance Scoring</a>
           
        </span><span class="next">
           
          <a href="query-time-boosting.html">Query-Time Boosting
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="practical-scoring-function"></a>Lucene’s Practical Scoring Function<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/15_Practical_scoring.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>For multiterm queries, Lucene takes<a id="id-1.5.8.9.2.1" class="indexterm"></a>
<a id="id-1.5.8.9.2.2" class="indexterm"></a>
<a id="id-1.5.8.9.2.3" class="indexterm"></a><a id="id-1.5.8.9.2.4" class="indexterm"></a> the <a class="link" href="scoring-theory.html#boolean-model" title="Boolean Model">Boolean model</a>,
<a class="link" href="scoring-theory.html#tfidf" title="Term Frequency/Inverse Document Frequency (TF/IDF)">TF/IDF</a>, and the <a class="link" href="scoring-theory.html#vector-space-model" title="Vector Space Model">vector space model</a> and
combines <a id="id-1.5.8.9.2.8" class="indexterm"></a><a id="id-1.5.8.9.2.9" class="indexterm"></a> them in a single efficient package that collects matching
documents and scores them as it goes.</p><p>A multiterm query like</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">GET /my_index/doc/_search
{
  "query": {
    "match": {
      "text": "quick fox"
    }
  }
}</pre></div><p>is rewritten internally to look like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">GET /my_index/doc/_search
{
  "query": {
    "bool": {
      "should": [
        {"term": { "text": "quick" }},
        {"term": { "text": "fox"   }}
      ]
    }
  }
}</pre></div><p>The <code class="literal">bool</code> query implements the Boolean model and, in this example, will
include only documents that contain either the term <code class="literal">quick</code> or the term <code class="literal">fox</code> or
both.</p><p>As soon as a document matches a query, Lucene calculates its score for that
query, combining the scores of each matching term.  The formula used for
scoring is called the <span class="emphasis"><em>practical scoring function</em></span>.<a id="id-1.5.8.9.8.2" class="indexterm"></a> It looks intimidating, but
don’t be put off—most of the components you already know. It introduces a
few new elements that we discuss next.</p><pre class="literallayout">score(q,d)  =  <a id="CO107-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            queryNorm(q)  <a id="CO107-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
          · coord(q,d)    <a id="CO107-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
          · ∑ (           <a id="CO107-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
                tf(t in d)   <a id="CO107-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
              · idf(t)²      <a id="CO107-6"></a><span><img src="images/icons/callouts/6.png" alt="" /></span>
              · t.getBoost() <a id="CO107-7"></a><span><img src="images/icons/callouts/7.png" alt="" /></span>
              · norm(t,d)    <a id="CO107-8"></a><span><img src="images/icons/callouts/8.png" alt="" /></span>
            ) (t in q)    <a id="CO107-9"></a><span><img src="images/icons/callouts/9.png" alt="" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">score(q,d)</code> is the relevance score of document <code class="literal">d</code> for query <code class="literal">q</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">queryNorm(q)</code> is the <a class="link" href="practical-scoring-function.html#query-norm" title="Query Normalization Factor"><span class="emphasis"><em>query normalization</em></span> factor</a> (new).
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">coord(q,d)</code> is the <a class="link" href="practical-scoring-function.html#coord" title="Query Coordination"><span class="emphasis"><em>coordination</em></span> factor</a> (new).
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> <a href="#CO107-9"><span><img src="images/icons/callouts/9.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The sum of the weights for each term <code class="literal">t</code> in the query <code class="literal">q</code> for document <code class="literal">d</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">tf(t in d)</code> is the <a class="link" href="scoring-theory.html#tf" title="Term frequency">term frequency</a> for term <code class="literal">t</code> in document <code class="literal">d</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-6"><span><img src="images/icons/callouts/6.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">idf(t)</code> is the <a class="link" href="scoring-theory.html#idf" title="Inverse document frequency">inverse document frequency</a> for term <code class="literal">t</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-7"><span><img src="images/icons/callouts/7.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">t.getBoost()</code> is the <a class="link" href="query-time-boosting.html" title="Query-Time Boosting"><span class="emphasis"><em>boost</em></span></a>  that has been
    applied to the query (new).
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-8"><span><img src="images/icons/callouts/8.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">norm(t,d)</code> is the <a class="link" href="scoring-theory.html#field-norm" title="Field-length norm">field-length norm</a>, combined with the
    <a class="link" href="practical-scoring-function.html#index-boost" title="Index-Time Field-Level Boosting">index-time field-level boost</a>, if any. (new).
</p></td></tr></table></div><p>You should recognize <code class="literal">score</code>, <code class="literal">tf</code>, and <code class="literal">idf</code>. The  <code class="literal">queryNorm</code>, <code class="literal">coord</code>,
<code class="literal">t.getBoost</code>, and <code class="literal">norm</code> are new.</p><p>We will talk more about <a class="link" href="query-time-boosting.html" title="Query-Time Boosting">query-time boosting</a>  later in
this chapter, but first let’s get query normalization, coordination, and
index-time field-level boosting out of the way.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="query-norm"></a>Query Normalization Factor<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/15_Practical_scoring.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <span class="emphasis"><em>query normalization factor</em></span> (<code class="literal">queryNorm</code>) is <a id="id-1.5.8.9.13.2.3" class="indexterm"></a>
<a id="id-1.5.8.9.13.2.4" class="indexterm"></a><a id="id-1.5.8.9.13.2.5" class="indexterm"></a><a id="id-1.5.8.9.13.2.6" class="indexterm"></a>
<a id="id-1.5.8.9.13.2.7" class="indexterm"></a>an attempt to <span class="emphasis"><em>normalize</em></span> a
query so that the results from one query may be compared with the results of
another.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>Even though the intent of the query norm is to make results from different
queries comparable, it doesn’t work very well. The only purpose of
the relevance <code class="literal">_score</code> is to sort the results of the current query in the
correct order. You should not try to compare the relevance scores from
different queries.</p></div></div><p>This factor is calculated at the beginning of the query. The actual
calculation depends on the queries involved, but a typical implementation is as follows:</p><pre class="literallayout">queryNorm = 1 / √sumOfSquaredWeights <a id="CO108-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO108-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">sumOfSquaredWeights</code> is calculated by adding together the IDF of each
    term in the query, squared.
</p></td></tr></table></div><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>The same query normalization factor is applied to every document, and you
have no way of changing it. For all intents and purposes, it can be ignored.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="coord"></a>Query Coordination<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/15_Practical_scoring.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <span class="emphasis"><em>coordination factor</em></span> (<code class="literal">coord</code>) is used to<a id="id-1.5.8.9.14.2.3" class="indexterm"></a><a id="id-1.5.8.9.14.2.4" class="indexterm"></a><a id="id-1.5.8.9.14.2.5" class="indexterm"></a>
<a id="id-1.5.8.9.14.2.6" class="indexterm"></a> reward documents that contain a
higher percentage of the query terms. The more query terms that appear in
the document, the greater the chances that the document is a good match for
the query.</p><p>Imagine that we have a query for <code class="literal">quick brown fox</code>, and that the
weight for each term is 1.5.  Without the coordination factor, the score would
just be the sum of the weights of the terms in a document. For instance:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Document with <code class="literal">fox</code> → score: 1.5
</li><li class="listitem">
Document with <code class="literal">quick fox</code> → score: 3.0
</li><li class="listitem">
Document with <code class="literal">quick brown fox</code> → score: 4.5
</li></ul></div><p>The coordination factor multiplies the score by the number of matching terms
in the document, and divides it by the total number of terms in the query.
With the coordination factor, the scores would be as follows:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Document with <code class="literal">fox</code> → score: <code class="literal">1.5 * 1 / 3</code> = 0.5
</li><li class="listitem">
Document with <code class="literal">quick fox</code> → score: <code class="literal">3.0 * 2 / 3</code> = 2.0
</li><li class="listitem">
Document with <code class="literal">quick brown fox</code> → score: <code class="literal">4.5 * 3 / 3</code> = 4.5
</li></ul></div><p>The coordination factor results in the document that contains all three terms
being much more relevant than the document that contains just two of them.</p><p>Remember that the query for <code class="literal">quick brown fox</code> is rewritten into a <code class="literal">bool</code> query
like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">GET /_search
{
  "query": {
    "bool": {
      "should": [
        { "term": { "text": "quick" }},
        { "term": { "text": "brown" }},
        { "term": { "text": "fox"   }}
      ]
    }
  }
}</pre></div><p>The <code class="literal">bool</code> query uses query coordination by default for all <code class="literal">should</code> clauses,
but it does allow you to disable coordination.  Why might you want to do this?
Well, usually the answer is, you don’t.  Query coordination is usually a good
thing.  When you use a <code class="literal">bool</code> query to wrap several high-level queries like
the <code class="literal">match</code> query, it also makes sense to leave coordination enabled. The more
clauses that match, the higher the degree of overlap between your search
request and the documents that are returned.</p><p>However, in some advanced use cases, it might make sense to disable
coordination.  Imagine that you are looking for the synonyms <code class="literal">jump</code>, <code class="literal">leap</code>, and
<code class="literal">hop</code>.  You don’t care how many of these synonyms are present, as they all
represent the same concept. In fact, only one of the synonyms is likely to be
present.  This would be a good case for disabling the coordination factor:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">GET /_search
{
  "query": {
    "bool": {
      "disable_coord": true,
      "should": [
        { "term": { "text": "jump" }},
        { "term": { "text": "hop"  }},
        { "term": { "text": "leap" }}
      ]
    }
  }
}</pre></div><p>When you use synonyms (see <a class="xref" href="synonyms.html" title="Synonyms"><em>Synonyms</em></a>), this is exactly what
happens internally: the rewritten query disables coordination for the
synonyms. <a id="id-1.5.8.9.14.13.2" class="indexterm"></a>
<a id="id-1.5.8.9.14.13.3" class="indexterm"></a>  Most use cases for disabling coordination are handled
automatically; you don’t need to worry about it.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="index-boost"></a>Index-Time Field-Level Boosting<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/15_Practical_scoring.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>We will talk about <span class="emphasis"><em>boosting</em></span> a field—making it <a id="id-1.5.8.9.15.2.2" class="indexterm"></a>
<a id="id-1.5.8.9.15.2.3" class="indexterm"></a><a id="id-1.5.8.9.15.2.4" class="indexterm"></a>
<a id="id-1.5.8.9.15.2.5" class="indexterm"></a><a id="id-1.5.8.9.15.2.6" class="indexterm"></a>
<a id="id-1.5.8.9.15.2.7" class="indexterm"></a>more important than other
fields—at query time in <a class="xref" href="query-time-boosting.html" title="Query-Time Boosting">Query-Time Boosting</a>.  It is also possible
to apply a boost to a field at index time.  Actually, this boost is applied to
every term in the field, rather than to the field itself.</p><p>To store this boost value in the index without using more space
than necessary, this field-level index-time boost is combined with the <a id="id-1.5.8.9.15.3.1" class="indexterm"></a>field-length norm (see  <a class="xref" href="scoring-theory.html#field-norm" title="Field-length norm">Field-length norm</a>) and stored in the index as a single byte.
This is the value returned by <code class="literal">norm(t,d)</code> in the preceding formula.</p><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>We strongly recommend against using field-level index-time boosts for a few
reasons:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Combining the boost with the field-length norm and storing it in a single
    byte means that the field-length norm loses precision. The result is that
    Elasticsearch is unable to distinguish between a field containing three words
    and a field containing five words.
</li><li class="listitem">
To change an index-time boost, you have to reindex all your documents.
    A query-time boost, on the other hand, can be changed with every query.
</li><li class="listitem">
If a field with an index-time boost has multiple values, the boost is
    multiplied by itself for every value, dramatically increasing
    the weight for that field.
</li></ul></div><p><a class="link" href="query-time-boosting.html" title="Query-Time Boosting">Query-time boosting</a> is a much simpler, cleaner, more
flexible option.</p></div></div><p>With query normalization, coordination, and index-time boosting out of the way,
we can now move on to the most useful tool for influencing the relevance
calculation: query-time boosting.<a id="id-1.5.8.9.15.5.1" class="indexterm"></a>
<a id="id-1.5.8.9.15.5.2" class="indexterm"></a>
<a id="id-1.5.8.9.15.5.3" class="indexterm"></a></p></div></div><div class="navfooter"><span class="prev"><a href="scoring-theory.html">
              « 
              Theory Behind Relevance Scoring</a>
           
        </span><span class="next">
           
          <a href="query-time-boosting.html">Query-Time Boosting
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        