<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Finding Exact Values
        | Elasticsearch: The Definitive Guide [2.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [2.x]" /><link rel="up" href="structured-search.html" title="Structured Search" /><link rel="prev" href="structured-search.html" title="Structured Search" /><link rel="next" href="combining-filters.html" title="Combining Filters" /><meta name="DC.type" content="Docs/Elasticsearch/Definitive Guide/2.x" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [2.x]
    </a></span> » <span class="breadcrumb-link"><a href="search-in-depth.html">Search in Depth </a></span> » <span class="breadcrumb-link"><a href="structured-search.html">Structured Search</a></span> » <span class="breadcrumb-node">Finding Exact Values</span></div><div class="navheader"><span class="prev"><a href="structured-search.html">
              « 
              Structured Search</a>
           
        </span><span class="next">
           
          <a href="combining-filters.html">Combining Filters
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_finding_exact_values"></a>Finding Exact Values<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/080_Structured_Search/05_term.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>When working with exact values,<a id="id-1.5.3.6.2.1" class="indexterm"></a>
<a id="id-1.5.3.6.2.2" class="indexterm"></a><a id="id-1.5.3.6.2.3" class="indexterm"></a>
<a id="id-1.5.3.6.2.4" class="indexterm"></a>
you will be working with non-scoring, filtering queries. Filters are
important because they are very fast.  They do not calculate
relevance (avoiding the entire scoring phase) and are easily cached. We’ll
talk about the performance benefits of filters later in <a class="xref" href="filter-caching.html" title="All About Caching">All About Caching</a>,
but for now, just keep in mind that you should use filtering queries as often as you
can.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_term_query_with_numbers"></a>term Query with Numbers<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/080_Structured_Search/05_term.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>We are going to explore the <code class="literal">term</code> query <a id="id-1.5.3.6.3.2.2" class="indexterm"></a>
<a id="id-1.5.3.6.3.2.3" class="indexterm"></a>
<a id="id-1.5.3.6.3.2.4" class="indexterm"></a>
<a id="id-1.5.3.6.3.2.5" class="indexterm"></a>
<a id="id-1.5.3.6.3.2.6" class="indexterm"></a>
first because you will use it often. This query is capable of handling numbers,
booleans, dates, and text.</p><p>We’ll start by indexing some documents representing products, each having a
 <code class="literal">price</code> and <code class="literal">productID</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST /my_store/products/_bulk
{ "index": { "_id": 1 }}
{ "price" : 10, "productID" : "XHDK-A-1293-#fJ3" }
{ "index": { "_id": 2 }}
{ "price" : 20, "productID" : "KDKE-B-9947-#kL5" }
{ "index": { "_id": 3 }}
{ "price" : 30, "productID" : "JODL-X-1937-#pV7" }
{ "index": { "_id": 4 }}
{ "price" : 30, "productID" : "QQPX-R-3956-#aD8" }</pre></div><div class="sense_widget" data-snippet="snippets/080_Structured_Search/05_Term_number.json"></div><p>Our goal is to find all products with a certain price.  You may be familiar
with SQL if you are coming from a relational database background.  If we
expressed this query as an SQL query, it would look like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sql">SELECT document
FROM   products
WHERE  price = 20</pre></div><p>In the Elasticsearch query DSL, we use a <code class="literal">term</code> query to accomplish the same
thing.  The <code class="literal">term</code> query will look for the exact value that we specify.  By
itself, a <code class="literal">term</code> query is simple. It accepts a field name and the value
that we wish to find:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
    "term" : {
        "price" : 20
    }
}</pre></div><p>Usually, when looking for an exact value, we don’t want to score the query.  We just
want to include/exclude documents, so we will use a <code class="literal">constant_score</code> query to execute
the <code class="literal">term</code> query in a non-scoring mode and apply a uniform score of one.</p><p>The final combination will be a <code class="literal">constant_score</code> query which contains a <code class="literal">term</code> query:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /my_store/products/_search
{
    "query" : {
        "constant_score" : { <a id="CO42-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            "filter" : {
                "term" : { <a id="CO42-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
                    "price" : 20
                }
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/080_Structured_Search/05_Term_number.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO42-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
We use a <code class="literal">constant_score</code> to convert the <code class="literal">term</code> query into a filter
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO42-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">term</code> query that we saw previously.
</p></td></tr></table></div><p>Once executed, the search results from this query are exactly what you would
expect: only document 2 is returned as a hit (because only <code class="literal">2</code> had a price
of <code class="literal">20</code>):</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">"hits" : [
    {
        "_index" : "my_store",
        "_type" :  "products",
        "_id" :    "2",
        "_score" : 1.0, <a id="CO43-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        "_source" : {
          "price" :     20,
          "productID" : "KDKE-B-9947-#kL5"
        }
    }
]</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO43-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Queries placed inside the <code class="literal">filter</code> clause do not perform scoring or relevance,
so all results receive a neutral score of <code class="literal">1</code>.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_term_query_with_text"></a>term Query with Text<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/080_Structured_Search/05_term.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>As mentioned at the top of <a id="id-1.5.3.6.4.2.1" class="indexterm"></a>
<a id="id-1.5.3.6.4.2.2" class="indexterm"></a>
<a id="id-1.5.3.6.4.2.3" class="indexterm"></a>
<a id="id-1.5.3.6.4.2.4" class="indexterm"></a>
<a id="id-1.5.3.6.4.2.5" class="indexterm"></a>this section, the <code class="literal">term</code> query can match strings
just as easily as numbers.  Instead of price, let’s try to find products that
have a certain UPC identification code. To do this with SQL, we might use a
query like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sql">SELECT product
FROM   products
WHERE  productID = "XHDK-A-1293-#fJ3"</pre></div><p>Translated into the query DSL, we can try a similar query with the <code class="literal">term</code>
filter, like so:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /my_store/products/_search
{
    "query" : {
        "constant_score" : {
            "filter" : {
                "term" : {
                    "productID" : "XHDK-A-1293-#fJ3"
                }
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/080_Structured_Search/05_Term_text.json"></div><p>Except there is a little hiccup: we don’t get any results back!  Why is
that? The problem isn’t with the <code class="literal">term</code> query; it is with the way
the data has been indexed. <a id="id-1.5.3.6.4.7.2" class="indexterm"></a> If we use the <code class="literal">analyze</code> API (<a class="xref" href="analysis-intro.html#analyze-api" title="Testing Analyzers">Testing Analyzers</a>), we
can see that our UPC has been tokenized into smaller tokens:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /my_store/_analyze?field=productID
XHDK-A-1293-#fJ3</pre></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "tokens" : [ {
    "token" :        "xhdk",
    "start_offset" : 0,
    "end_offset" :   4,
    "type" :         "&lt;ALPHANUM&gt;",
    "position" :     1
  }, {
    "token" :        "a",
    "start_offset" : 5,
    "end_offset" :   6,
    "type" :         "&lt;ALPHANUM&gt;",
    "position" :     2
  }, {
    "token" :        "1293",
    "start_offset" : 7,
    "end_offset" :   11,
    "type" :         "&lt;NUM&gt;",
    "position" :     3
  }, {
    "token" :        "fj3",
    "start_offset" : 13,
    "end_offset" :   16,
    "type" :         "&lt;ALPHANUM&gt;",
    "position" :     4
  } ]
}</pre></div><div class="sense_widget" data-snippet="snippets/080_Structured_Search/05_Term_text.json"></div><p>There are a few important points here:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
We have four distinct tokens instead of a single token representing the UPC.
</li><li class="listitem">
All letters have been lowercased.
</li><li class="listitem">
We lost the hyphen and the hash (<code class="literal">#</code>) sign.
</li></ul></div><p>So when our <code class="literal">term</code> query looks for the exact value <code class="literal">XHDK-A-1293-#fJ3</code>, it
doesn’t find anything, because that token does not exist in our inverted index.
Instead, there are the four tokens listed previously.</p><p>Obviously, this is not what we want to happen when dealing with identification
codes, or any kind of precise enumeration.</p><p>To prevent this from happening, we need to tell Elasticsearch that this field
contains an exact value by  setting it to be <code class="literal">not_analyzed</code>.<a id="id-1.5.3.6.4.15.2" class="indexterm"></a> We saw this
originally in <a class="xref" href="mapping-intro.html#custom-field-mappings" title="Customizing Field Mappings">Customizing Field Mappings</a>.  To do this, we need to first delete
our old index (because it has the incorrect mapping) and create a new one with
the correct mappings:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">DELETE /my_store <a id="CO44-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>

PUT /my_store <a id="CO44-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
{
    "mappings" : {
        "products" : {
            "properties" : {
                "productID" : {
                    "type" : "string",
                    "index" : "not_analyzed" <a id="CO44-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
                }
            }
        }
    }

}</pre></div><div class="sense_widget" data-snippet="snippets/080_Structured_Search/05_Term_text.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO44-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Deleting the index first is required, since we cannot change mappings that
    already exist.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO44-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
With the index deleted, we can re-create it with our custom mapping.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO44-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Here we explicitly say that we don’t want <code class="literal">productID</code> to be analyzed.
</p></td></tr></table></div><p>Now we can go ahead and reindex our documents:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST /my_store/products/_bulk
{ "index": { "_id": 1 }}
{ "price" : 10, "productID" : "XHDK-A-1293-#fJ3" }
{ "index": { "_id": 2 }}
{ "price" : 20, "productID" : "KDKE-B-9947-#kL5" }
{ "index": { "_id": 3 }}
{ "price" : 30, "productID" : "JODL-X-1937-#pV7" }
{ "index": { "_id": 4 }}
{ "price" : 30, "productID" : "QQPX-R-3956-#aD8" }</pre></div><div class="sense_widget" data-snippet="snippets/080_Structured_Search/05_Term_text.json"></div><p>Only now will our <code class="literal">term</code> query work as expected.  Let’s try it again on the
newly indexed data (notice, the query and filter have not changed at all, just
how the data is mapped):</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /my_store/products/_search
{
    "query" : {
        "constant_score" : {
            "filter" : {
                "term" : {
                    "productID" : "XHDK-A-1293-#fJ3"
                }
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/080_Structured_Search/05_Term_text.json"></div><p>Since the <code class="literal">productID</code> field is not analyzed, and the <code class="literal">term</code> query performs no
analysis, the query finds the exact match and returns document 1 as a hit.
Success!</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_internal_filter_operation"></a>Internal Filter Operation<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/080_Structured_Search/05_term.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Internally, Elasticsearch is<a id="id-1.5.3.6.5.2.1" class="indexterm"></a>
<a id="id-1.5.3.6.5.2.2" class="indexterm"></a>
<a id="id-1.5.3.6.5.2.3" class="indexterm"></a>
<a id="id-1.5.3.6.5.2.4" class="indexterm"></a>
<a id="id-1.5.3.6.5.2.5" class="indexterm"></a> performing several operations when executing a
non-scoring query:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
<span class="emphasis"><em>Find matching docs</em></span>.
</p><p class="simpara">The <code class="literal">term</code> query looks up the term <code class="literal">XHDK-A-1293-#fJ3</code> in the inverted index
and retrieves the list of documents that contain that term.  In this case,
only document 1 has the term we are looking for.</p></li><li class="listitem"><p class="simpara">
<span class="emphasis"><em>Build a bitset</em></span>.
</p><p class="simpara">The filter then builds a <span class="emphasis"><em>bitset</em></span>--an array of 1s and 0s—that
describes which documents contain the term.  Matching documents receive a  <code class="literal">1</code>
bit.  In our example, the bitset would be <code class="literal">[1,0,0,0]</code>.  Internally, this is represented
as a <a class="ulink" href="https://www.elastic.co/blog/frame-of-reference-and-roaring-bitmaps" target="_top">"roaring bitmap"</a>,
which can efficiently encode both sparse and dense sets.</p></li><li class="listitem"><p class="simpara">
<span class="emphasis"><em>Iterate over the bitset(s)</em></span>
</p><p class="simpara">Once the bitsets are generated for each query, Elasticsearch iterates over the
bitsets to find the set of matching documents that satisfy all filtering criteria.
The order of execution is decided heuristically, but generally the most sparse
bitset is iterated on first (since it excludes the largest number of documents).</p></li><li class="listitem"><p class="simpara">
<span class="emphasis"><em>Increment the usage counter</em></span>.
</p><p class="simpara">Elasticsearch can cache non-scoring queries for faster access, but its silly to
cache something that is used only rarely.  Non-scoring queries are already quite fast
due to the inverted index, so we only want to cache queries we <span class="emphasis"><em>know</em></span> will be used
again in the future to prevent resource wastage.</p><p class="simpara">To do this, Elasticsearch tracks the history of query usage on a per-index basis.
If a query is used more than a few times in the last 256 queries, it is cached
in memory.  And when the bitset is cached, caching is omitted on segments that have
fewer than 10,000 documents (or less than 3% of the total index size). These
small segments tend to disappear quickly anyway and it is a waste to associate a
cache with them.</p></li></ol></div><p>Although not quite true in reality (execution is a bit more complicated based on
how the query planner re-arranges things, and some heuristics based on query cost),
you can conceptually think of non-scoring queries as executing <span class="emphasis"><em>before</em></span> the scoring
queries.  The job of non-scoring queries is to reduce the number of documents that
the more costly scoring queries need to evaluate, resulting in a faster search request.</p><p>By conceptually thinking of non-scoring queries as executing first, you’ll be
equipped to write efficient and fast search requests.</p></div></div><div class="navfooter"><span class="prev"><a href="structured-search.html">
              « 
              Structured Search</a>
           
        </span><span class="next">
           
          <a href="combining-filters.html">Combining Filters
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        