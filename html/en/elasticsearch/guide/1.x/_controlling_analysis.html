<!DOCTYPE html><html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Controlling Analysis
        | Elasticsearch: The Definitive Guide [1.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [1.x]" /><link rel="up" href="full-text-search.html" title="Full-Text Search" /><link rel="prev" href="_boosting_query_clauses.html" title="Boosting Query Clauses" /><link rel="next" href="relevance-is-broken.html" title="Relevance Is Broken!" /><meta name="DC.type" content="Docs/Elasticsearch/Definitive Guide/1.x" /><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png?change=123"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png?change=123"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png?change=123"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png?change=123"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png?change=123"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png?change=123"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png?change=123"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png?change=123"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png?change=123"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png?change=123"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?change=123"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png?change=123"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?change=123"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"><meta name="description" content=""/><meta property="og:image" content="/static/img/cluster-small.png"/><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link rel="icon" href="favicon.ico?change=123" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="64x64" href="favicon_64x64_16bit.png"><link rel="apple-touch-icon-precomposed" sizes="32x32" href="favicon_32x32.png"><link rel="apple-touch-icon-precomposed" sizes="16x16" href="favicon_16x16.png"><link href="/static/css/main.css" rel="stylesheet"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--><link type="text/css" rel="stylesheet" href="/static/css/prettify.css"/><link type="text/css" rel="stylesheet" href="/static/css/guide.css"/><script type="text/javascript" src="/static/js/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css" />

</head><body><script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script><header class="header-wrapper"><div class="navigation-wrapper"><div class="container"><nav class="navbar"><div class="navbar-mobile-header navbar-header mr-20 mr-xs-0"><div class="row hidden-sm hidden-md hidden-lg"><div class="col-xs-5 hidden-sm hidden-md hidden-lg"><div class="navbar-mobile-header-icon navbar-mobile-header-icon-out"><span></span><span></span><span></span></div> <a href="/learn" class="nav-title hidden-sm hidden-md hidden-lg m-l-10">Learn</a></div><div class="col-xs-2 text-center"><div class="navbar-brand" id="elastic"><h1> <a class="logo-m hidden-sm hidden-md hidden-lg" href="/"><img src="/assets/blt65c71c1236219a27/elastic-logo-mobile.svg" alt="elastic-logo-mobile"></a></h1></div></div><div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right"><ul class="menu-m hidden-sm hidden-md hidden-lg"><li class=""><a class="icon-contact" href="/contact"></a></li><li id="searchbar"><a class="button icon" href="#"></a></li><li class="lang global-language"><a href="#">EN</a><ul class="language-list"><li><a href="/">English</a></li><li><a href="/fr/">français</a></li><li><a href="/de/">Deutsche</a></li><li><a href="/jp/">日本語</a></li><li><a href="/kr/">한국어</a></li></ul></li></ul></div></div><div class="navbar-brand hidden-xs" id="elastic"><h1> <a class="hidden-xs" id="elastic-logo" href="/"><img src="/assets/blt49aa5273c3bf983b/elastic-logo.svg" alt="elastic-logo"></a></h1></div></div><div class="collapse navbar-collapse mobile-inner-nav"><nav class="nav navbar-nav primary-nav-hover" id="nav"><ul><li> <a id="nav_products" class="  nav-item" href="/products">Products</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/products/elasticsearch">Elasticsearch</a></li><li> <a href="/cloud">Elasticsearch as a Service</a></li><li> <a href="/products/logstash">Logstash</a></li><li> <a href="/products/kibana">Kibana</a></li><li> <a href="/products/beats">Beats</a></li><li> <a href="/products/watcher">Watcher</a></li><li> <a href="/products/shield">Shield</a></li><li> <a href="/products/marvel">Marvel</a></li><li> <a href="/products/graph">Graph</a></li><li> <a href="/products/reporting">Reporting</a></li><li> <a href="/products/hadoop">Hadoop</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_elasticsearch" href="/products/elasticsearch">Elasticsearch</a></li><li><a id="nav_elasticsearch as a service" href="/cloud">Elasticsearch as a Service</a></li><li><a id="nav_logstash" href="/products/logstash">Logstash</a></li><li><a id="nav_kibana" href="/products/kibana">Kibana</a></li><li><a id="nav_beats" href="/products/beats">Beats</a></li><li><a id="nav_watcher" href="/products/watcher">Watcher</a></li><li><a id="nav_shield" href="/products/shield">Shield</a></li><li><a id="nav_marvel" href="/products/marvel">Marvel</a></li><li><a id="nav_graph" href="/products/graph">Graph</a></li><li><a id="nav_reporting" href="/products/reporting">Reporting</a></li><li><a id="nav_hadoop" href="/products/hadoop">Hadoop</a></li></ul></li><li> <a id="nav_cloud" class="  nav-item" href="/cloud">Cloud</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/cloud/subscriptions">Subscriptions</a></li><li> <a href="/cloud/pricing">Pricing</a></li><li> <a href="/cloud/support">Support</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_subscriptions" href="/cloud/subscriptions">Subscriptions</a></li><li><a id="nav_pricing" href="/cloud/pricing">Pricing</a></li><li><a id="nav_support" href="/cloud/support">Support</a></li></ul></li><li> <a id="nav_services" class="  nav-item" href="/services">Services</a></li><li> <a id="nav_customers" class="  nav-item" href="/use-cases">Customers</a></li><li> <a id="nav_learn" class="active nav-item" href="/learn">Learn</a><div class="text-center quaternary-nav hidden-xs hover-nav"><div class="container"><div class="p-t-b-5"><ul class="list-inline nav-group"><li> <a href="/community">Community</a></li><li> <a href="/guide">Docs</a></li><li> <a href="/blog">Blog</a></li><li> <a href="/videos">Videos</a></li><li> <a href="https://discuss.elastic.co/">Forums</a></li><li> <a href="/elasticon">Elastic{ON}</a></li></ul></div></div></div><ul class="hidden-sm hidden-md hidden-lg sub-navigation"><li><a id="nav_community" href="/community">Community</a></li><li><a id="nav_docs" href="/guide">Docs</a></li><li><a id="nav_blog" href="/blog">Blog</a></li><li><a id="nav_videos" href="/videos">Videos</a></li><li><a id="nav_forums" href="https://discuss.elastic.co/">Forums</a></li><li><a id="nav_elastic{on}" href="/elasticon">Elastic{ON}</a></li></ul></li></ul></nav><nav class="nav navbar-nav navbar-right hidden-xs"><ul><li class="hidden-xs hidden-sm"><a href="/downloads">Downloads</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li><li class="hidden-xs hidden-sm"><a class="btn btn-primary btn-contact" href="/contact">Contact</a></li><li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact"></a></li><li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li><li class="hidden-xs lang global-language"><a href="#">EN</a><ul class="language-list"><li><a class="" href="/">English</a></li><li><a class="" href="/fr/">français</a></li><li><a class="" href="/de/">Deutsche</a></li><li><a class="" href="/jp/">日本語</a></li><li><a class="" href="/kr/">한국어</a></li></ul></li></ul></nav></div></nav></div></div><div class="header-search-wrapper open-search"><div class="container"><div class="big-search"><i class="big-search-icon"></i><form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get"><ul class="tags-wrapper"><li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li></ul></form><a class="header-search-cancel" href="#"></a></div><div class="nav-auto-complete"></div></div></div><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script>
$(window).load(function () {
  $(".navbar-mobile-header-icon").click(function(index){
    $('.navigation-wrapper').toggleClass('menu-overlay');
    $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
    $(".mobile-inner-nav").slideToggle(500);
    $('.mobile-inner-nav .sub-navigation').css('display','none');
    $(".mobile-inner-nav a").each(function( index ) {
      $(this).css({'animation-delay': (index/25)+'s'});
    });
  });

  if($(window).width() < 769){
    $(".nav-item").click(function(e){
      e.preventDefault();
      var parent = $(this).parent();
      $('.sub-navigation',parent).slideToggle(250);
    })
  }
});
</script></header><style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt78ef101d1c58b693/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt8c2d02cd42735ac3/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blte4c9f7f37cf09587/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
      
</style><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script type="text/javascript" src="/static/js/nav-v5.js"></script><script type="text/javascript">
  $(document).ready( function(){
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
      console.log("close");
    });

    // $(".mobile-inner-header-icon").click(function(){
    //   $(this).toggleClass("mobile-inner-header-icon-click mobile-inner-header-icon-out");
    //   $(".mobile-inner-nav").slideToggle(250);
    //   $(".navigation-wrapper").toggleClass('mobile-menu');
    //   if ($('.mobile-inner-header-icon-click').is(":visible")) {
    //     $('.menu-m').css({'display':"none"});
    //   }else{
    //     $('.menu-m').css({'display':"table-cell"});
    //   }
    // });
    // $(".mobile-inner-nav a").each(function( index ) {
    //   $( this ).css({'animation-delay': (index/10)+'s'});
    //   // $(".navigation-wrapper").removeClass('mobile-menu');
    // });
  });
</script><div class="tertiary-nav"><div class="container"><div class="p-t-b-13 bdr-btm-e7e7e7 clearfix"><div class="breadcrum-wrapper pull-left text-left"> <a href="/learn">Learn</a> <span>Docs</span></div></div></div></div><div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg clearfix"><div class="container"><div class="breadcrum-wrapper pull-left text-left"> <a class="dropdown-btn" href="javascript:void(0)">Docs</a></div></div></div><div class="main-container"><section id="content"><div class="content-wrapper">
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="page_header"><b>PLEASE NOTE:</b>
<br/>
This page is for an older version of the software. Check out the <a href="../current/index.html">latest
version&#39;s documentation here</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="search-in-depth.html">Search in Depth </a></span> » <span class="breadcrumb-link"><a href="full-text-search.html">Full-Text Search</a></span> » <span class="breadcrumb-node">Controlling Analysis</span></div><div class="navheader"><span class="prev"><a href="_boosting_query_clauses.html">
              « 
              Boosting Query Clauses</a>
           
        </span><span class="next">
           
          <a href="relevance-is-broken.html">Relevance Is Broken!
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_controlling_analysis"></a>Controlling Analysis<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/100_Full_Text_Search/30_Controlling_analysis.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Queries can find only terms that actually <a id="id-1.5.4.12.2.1" class="indexterm"></a>
<a id="id-1.5.4.12.2.2" class="indexterm"></a><a id="id-1.5.4.12.2.3" class="indexterm"></a>
<a id="id-1.5.4.12.2.4" class="indexterm"></a>exist in the inverted index, so it
is important to ensure that the same analysis process is applied both to the
document at index time, and to the query string at search time so that the
terms in the query match the terms in the inverted index.</p><p>Although we say <span class="emphasis"><em>document</em></span>, analyzers are determined per field.<a id="id-1.5.4.12.3.2" class="indexterm"></a>
<a id="id-1.5.4.12.3.3" class="indexterm"></a> Each
field can have a different analyzer, either by configuring a specific analyzer
for that field or by falling back on the type, index, or node defaults.  At
index time, a field’s value is analyzed by using the configured or default
analyzer for that field.</p><p>For instance, let’s add a new field to <code class="literal">my_index</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT /my_index/_mapping/my_type
{
    "my_type": {
        "properties": {
            "english_title": {
                "type":     "string",
                "analyzer": "english"
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/100_Full_Text_Search/30_Analysis.json"></div><p>Now we can compare how values in the <code class="literal">english_title</code> field and the <code class="literal">title</code> field are
analyzed at index time by using the <code class="literal">analyze</code> API to analyze the word <code class="literal">Foxes</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /my_index/_analyze?field=my_type.title   <a id="CO66-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
Foxes

GET /my_index/_analyze?field=my_type.english_title <a id="CO66-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
Foxes</pre></div><div class="sense_widget" data-snippet="snippets/100_Full_Text_Search/30_Analysis.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO66-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Field <code class="literal">title</code>, which uses the default <code class="literal">standard</code> analyzer, will return the
    term <code class="literal">foxes</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO66-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Field <code class="literal">english_title</code>, which uses the <code class="literal">english</code> analyzer, will return the term
    <code class="literal">fox</code>.
</p></td></tr></table></div><p>This means that, were we to run a low-level <code class="literal">term</code> query for the exact term
<code class="literal">fox</code>, the <code class="literal">english_title</code> field would match but the <code class="literal">title</code> field would
not.</p><p>High-level queries like the <code class="literal">match</code> query understand field mappings and can
apply the correct analyzer for each field being queried.<a id="id-1.5.4.12.12.2" class="indexterm"></a>
<a id="id-1.5.4.12.12.3" class="indexterm"></a> We can see this
in action with <a id="id-1.5.4.12.12.4" class="indexterm"></a>the <code class="literal">validate-query</code> API:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /my_index/my_type/_validate/query?explain
{
    "query": {
        "bool": {
            "should": [
                { "match": { "title":         "Foxes"}},
                { "match": { "english_title": "Foxes"}}
            ]
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/100_Full_Text_Search/30_Analysis.json"></div><p>which returns this <code class="literal">explanation</code>:</p><pre class="literallayout">(title:foxes english_title:fox)</pre><p>The <code class="literal">match</code> query uses the appropriate analyzer for each field to ensure
that it looks for each term in the correct format for that field.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_default_analyzers"></a>Default Analyzers<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/100_Full_Text_Search/30_Controlling_analysis.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>While we can specify an analyzer at the field level,<a id="id-1.5.4.12.18.2.1" class="indexterm"></a>
<a id="id-1.5.4.12.18.2.2" class="indexterm"></a>
<a id="id-1.5.4.12.18.2.3" class="indexterm"></a><a id="id-1.5.4.12.18.2.4" class="indexterm"></a>
<a id="id-1.5.4.12.18.2.5" class="indexterm"></a> how do we determine which
analyzer is used for a field if none is specified at the field level?</p><p>Analyzers can be specified at several levels.  Elasticsearch works through
each level until it finds an analyzer that it can use.  At index time, the
order <a id="id-1.5.4.12.18.3.1" class="indexterm"></a>
<a id="id-1.5.4.12.18.3.2" class="indexterm"></a>is as follows:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
The <code class="literal">analyzer</code> defined in the field mapping, else
</li><li class="listitem">
<span class="emphasis"><em>The analyzer defined in the <code class="literal">_analyzer</code> field of the document, else</em></span>
</li><li class="listitem">
The default <code class="literal">analyzer</code> for the <code class="literal">type</code>, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default</code> in the index settings, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default</code> at node level, which defaults to
</li><li class="listitem">
The <code class="literal">standard</code> analyzer
</li></ul></div><p>At search time, the <a id="id-1.5.4.12.18.5.1" class="indexterm"></a>
<a id="id-1.5.4.12.18.5.2" class="indexterm"></a>sequence is slightly different:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="emphasis"><em>The <code class="literal">analyzer</code> defined in the query itself, else</em></span>
</li><li class="listitem">
The <code class="literal">analyzer</code> defined in the field mapping, else
</li><li class="listitem">
The default <code class="literal">analyzer</code> for the <code class="literal">type</code>, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default</code> in the index settings, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default</code> at node level, which defaults to
</li><li class="listitem">
The <code class="literal">standard</code> analyzer
</li></ul></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The two lines in italics in the preceding lists highlight differences in the index time sequence and the search time sequence.  The <code class="literal">_analyzer</code> field allows you to specify a default analyzer for each document (for example, <code class="literal">english</code>, <code class="literal">french</code>, <code class="literal">spanish</code>) while the <code class="literal">analyzer</code> parameter in the query specifies which analyzer to use on the query string. However, this is not the best way to handle multiple languages
in a single index because of the pitfalls highlighted in <a class="xref" href="languages.html" title="Dealing with Human Language">Dealing with Human Language </a>.</p></div></div><p>Occasionally, it makes sense to use a different analyzer at index and search
time.<a id="id-1.5.4.12.18.8.1" class="indexterm"></a>
<a id="id-1.5.4.12.18.8.2" class="indexterm"></a> For instance, at index time we may want to index synonyms (for example, for every
occurrence of <code class="literal">quick</code>, we also index <code class="literal">fast</code>, <code class="literal">rapid</code>, and <code class="literal">speedy</code>). But at
search time, we don’t need to search for all of these synonyms.  Instead we
can just look up the single word that the user has entered, be it <code class="literal">quick</code>,
<code class="literal">fast</code>, <code class="literal">rapid</code>, or <code class="literal">speedy</code>.</p><p>To enable this distinction, Elasticsearch also supports <a id="id-1.5.4.12.18.9.1" class="indexterm"></a><a id="id-1.5.4.12.18.9.2" class="indexterm"></a>the <code class="literal">index_analyzer</code>
and <code class="literal">search_analyzer</code> parameters, and<a id="id-1.5.4.12.18.9.5" class="indexterm"></a> <a id="id-1.5.4.12.18.9.6" class="indexterm"></a>analyzers named <code class="literal">default_index</code> and
<code class="literal">default_search</code>.</p><p>Taking these extra parameters into account, the <span class="emphasis"><em>full</em></span> sequence at index time
really looks like this:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
The <code class="literal">index_analyzer</code> defined in the field mapping, else
</li><li class="listitem">
The <code class="literal">analyzer</code> defined in the field mapping, else
</li><li class="listitem">
The analyzer defined in the <code class="literal">_analyzer</code> field of the document, else
</li><li class="listitem">
The default <code class="literal">index_analyzer</code> for the <code class="literal">type</code>, which defaults to
</li><li class="listitem">
The default <code class="literal">analyzer</code> for the <code class="literal">type</code>, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default_index</code> in the index settings, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default</code> in the index settings, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default_index</code> at node level, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default</code> at node level, which defaults to
</li><li class="listitem">
The <code class="literal">standard</code> analyzer
</li></ul></div><p>And at search time:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
The <code class="literal">analyzer</code> defined in the query itself, else
</li><li class="listitem">
The <code class="literal">search_analyzer</code> defined in the field mapping, else
</li><li class="listitem">
The <code class="literal">analyzer</code> defined in the field mapping, else
</li><li class="listitem">
The default <code class="literal">search_analyzer</code> for the <code class="literal">type</code>, which defaults to
</li><li class="listitem">
The default <code class="literal">analyzer</code> for the <code class="literal">type</code>, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default_search</code> in the index settings, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default</code> in the index settings, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default_search</code> at node level, which defaults to
</li><li class="listitem">
The analyzer named <code class="literal">default</code> at node level, which defaults to
</li><li class="listitem">
The <code class="literal">standard</code> analyzer
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_configuring_analyzers_in_practice"></a>Configuring Analyzers in Practice<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/100_Full_Text_Search/30_Controlling_analysis.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The sheer number of places where you can specify an analyzer is quite
overwhelming.<a id="id-1.5.4.12.19.2.1" class="indexterm"></a>
<a id="id-1.5.4.12.19.2.2" class="indexterm"></a>
<a id="id-1.5.4.12.19.2.3" class="indexterm"></a><a id="id-1.5.4.12.19.2.4" class="indexterm"></a>
<a id="id-1.5.4.12.19.2.5" class="indexterm"></a>  In practice, though, it is pretty simple.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_use_index_settings_not_config_files"></a>Use index settings, not config files<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/100_Full_Text_Search/30_Controlling_analysis.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>The first thing to remember is that, even though you may start out using
Elasticsearch for a single purpose or a single application such as logging,
chances are that you will find more use cases and end up running several
distinct applications on the same cluster.  Each index needs to be independent
and independently configurable. You don’t want to set defaults for one use
case, only to have to override them for another use case later.</p><p>This rules out configuring analyzers at the node level.  Additionally,
configuring analyzers at the node level requires changing the config file on every
node and restarting every node, which becomes a maintenance nightmare. It’s a
much better idea to keep Elasticsearch running and to manage settings only via
the API.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_keep_it_simple"></a>Keep it simple<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/100_Full_Text_Search/30_Controlling_analysis.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Most of the time, you will know what fields your documents will contain ahead
of time.  The simplest approach is to set the analyzer for each full-text
field when you create your index or add type mappings.  While this approach is
slightly more verbose, it enables you to easily see which analyzer is being applied
to each field.</p><p>Typically, most of your string fields will be exact-value <code class="literal">not_analyzed</code>
fields such as tags or enums, plus a handful of full-text fields that will
use some default analyzer like <code class="literal">standard</code> or <code class="literal">english</code> or some other language.
Then you may have one or two fields that need custom analysis: perhaps the
<code class="literal">title</code> field needs to be indexed in a way that supports <span class="emphasis"><em>find-as-you-type</em></span>.</p><p>You can set the <code class="literal">default</code> analyzer in the index to the analyzer you want to
use for almost all full-text fields, and just configure the specialized
analyzer on the one or two fields that need it.  If, in your model, you need
a different default analyzer per type, then use the type level <code class="literal">analyzer</code>
setting instead.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>A common work flow for time based data like logging is to create a new index
per day on the fly by just indexing into it.  While this work flow prevents
you from creating your index up front, you can still use
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-templates.html" target="_top">index templates</a>
to specify the settings and mappings that a new index should have.</p></div></div></div></div></div><div class="navfooter"><span class="prev"><a href="_boosting_query_clauses.html">
              « 
              Boosting Query Clauses</a>
           
        </span><span class="next">
           
          <a href="relevance-is-broken.html">Relevance Is Broken!
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
         class="col-xs-12 col-sm-4 col-md-4"><h3>Top Videos</h3><ul><li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li><li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li><li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li></ul><hr/></div></div></div></section></div><script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script><div class="subscribe-wrapper"><div class="container text-left"><div class="subscribe-title"><h5>Be in the know with the latest and greatest from Elastic.</h5></div><div class="subscribe-form"><form id="mktoForm_1398" class="mktoForm sb-form"></form><div class="form_thanks hide"><p>Thanks for subscribing! We'll keep you updated with new releases.</p></div></div></div></div><footer class="footer-wrapper"><div class="container"><div class="row footer-content"><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/products">Products</a></h3><ul><li><a href="/products/elasticsearch">Elasticsearch</a></li><li><a href="/products/kibana">Kibana</a></li><li><a href="/products/logstash">Logstash</a></li><li><a href="/products/beats">Beats</a></li><li><a href="/cloud">Elastic Cloud</a></li><li><a href="/products/shield">Shield (Security)</a></li><li><a href="/products/watcher">Watcher (Alerting)</a></li><li><a href="/products/marvel">Marvel (Monitoring)</a></li><li><a href="/products/graph">Graph</a></li><li><a href="/products/reporting">Reporting</a></li><li><a href="/products/hadoop">ES-Hadoop</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Resources</h3><ul><li><a href="/blog">Blog</a></li><li><a href="/community">Community</a></li><li><a href="/use-cases">Customers & Use Cases</a></li><li><a href="/guide">Documentation</a></li><li><a href="/elasticon">Elastic{ON} Events</a></li><li><a href="https://discuss.elastic.co/">Forums</a></li><li><a href="/community/meetups">Meetups</a></li><li><a href="https://support.elastic.co">Support Portal/Login</a></li><li><a href="/videos">Videos & Webinars</a></li><li><a href="/training">Training</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3><a href="/about">About</a></h3><ul><li><a href="/about/careers">Careers</a></li><li><a href="/contact">Contact</a></li><li><a href="/about/leadership">Leadership</a></li><li><a href="/about/partners">Partners</a></li><li><a href="/about/press">Press</a></li></ul></div><div class="col-xs-6 col-sm-3 col-md-3"><h3>Language</h3><ul><li><a href="/">English</a></li><li><a href="/fr">French</a></li><li><a href="/de">German</a></li><li><a href="/jp">Japanese</a></li><li><a href="/kr">Korean</a></li></ul></div></div><div class="row social-icon"><div class="col-xs-12 col-sm-12 col-md-12"><ul><li class="facebook"><a target="_blank" id="footer_facebook" href="http://www.facebook.com/elastic.co" target="_blank"></a></li><li class="twitter"><a target="_blank" id="footer_twitter" href="https://www.twitter.com/elastic" target="_blank"></a></li><li class="linkedin"><a target="_blank" id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co" target="_blank"></a></li><li class="xing"><a target="_blank" id="footer_xing" href="https://www.xing.com/companies/elastic.co" target="_blank"></a></li><li class="youtube"><a target="_blank" id="footer_youtube" href="https://www.youtube.com/user/elasticsearch" target="_blank"></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="copyright"><ul><li><a href="/legal/trademarks">Trademarks</a></li><li><a href="" legal="" terms-of-use"="">Terms of Use</a></li><li><a href="" legal="" privacy-policy"="">Privacy</a></li><li><a href="" legal="" privacy-and-cookie-policy"="">Cookie Policy</a></li><li><a href="/brand">Brand</a></li></ul><div class="copyright-content"><div class="footer-logo"><a href="#"><img src="/static/images/elastic-logo-H-full color.png" class="img-responsive"></a></div><div class="footer-text"><p>© 2016. All Rights Reserved - Elasticsearch</p><p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.</p></div></div></div></div></div></div></footer><style type="text/css">
		
			.facebook{background:url("/assets/bltf66b1b8a624e81b2/facebook.svg") no-repeat;}		
		
			.twitter{background:url("/assets/blt0c27fbeba1f2b85b/twitter.svg") no-repeat;}		
		
			.linkedin{background:url("/assets/blt7890ae949fd3873f/linkedin.svg") no-repeat;}		
		
			.xing{background:url("/assets/blt0d0981773de2643c/xing.svg") no-repeat;}		
		
			.youtube{background:url("/assets/blt891f87ea1aa18977/youtube.svg") no-repeat;}		
		
	</style><script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
  form.onSuccess(function(form){
    $('#mktoForm_1398').css('display','none');
    $('#subscribe-newsletter header').hide();
    $('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
    dataLayer.push({'event': 'mktoFormSubmit'});
      return false;
    });
});
</script><script src="/static/js/jquery.min.js"></script><script src="/static/js/bootstrap.min.js"></script><script src="/static/js/jquery.autocomplete.js"></script><script src="/static/js/script.js"></script></section></div><script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script><script src="/static/js/jquery.cookie.js"></script><style></style><script type="text/javascript">
       $(document).ready(function(){
        $('.dropdown-btn').on('click', function(){
          myFunction();
        });
         function myFunction() {
            // document.getElementById("myDropdown").classList.toggle("show");
            $('#myDropdown').toggleClass('show');
        }

        // Close the dropdown menu if the user clicks outside of it
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {

            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
       });
     </script>
            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        